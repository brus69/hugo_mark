<!DOCTYPE html>
<html lang="ru" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>  
    Как создать ИИ-агент с вызовом функций и GPT-5 | На пути к науке о данных
     | P9X
  </title>
  <meta name="description" content="">
<meta name="yandex-verification" content="242f5a0ee52d5836" />
<meta name="google-site-verification" content="0Ytq4iozDTscUw8IMVUsSsLQ4yEXHRwKZSvFYqnSNtE" />
<link rel="canonical" href="http://localhost:1313/how-to-build-an-ai-agent-with-function-calling-and-gpt-/" />

<link rel="icon" type="image/x-icon" href="http://localhost:1313/favicon.ico">

  
 <style>
  .content h1 { 
        font-size: 1.875rem; 
        font-weight: bold; 
        margin-bottom: 1rem; 
    }
    .content h2 { 
        font-size: 1.5rem; 
        font-weight: 600; 
        margin-bottom: 0.75rem; 
    }
    .content h3 { 
        font-size: 1.25rem; 
        font-weight: 500; 
        margin-bottom: 0.5rem; 
    }
    .content p { 
        margin-bottom: 1rem; 
    }
    .content ul { 
        list-style-type: disc; 
        list-style-position: inside; 
        margin-bottom: 1rem; 
    }
    .content ol { 
        list-style-type: decimal; 
        list-style-position: inside; 
        margin-bottom: 1rem; 
    }
    .content a { 
        color: #2563eb; 
    }
    .content a:hover { 
        color: #1e40af; 
    }
    .content blockquote { 
        border-left: 4px solid #d1d5db; 
        padding-left: 1rem; 
        font-style: italic; 
    }

    
.content table {
    width: 100%;
    border-collapse: collapse;
    margin: 1.5rem 0;
    font-size: 0.875rem;
    box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
    border-radius: 0.5rem;
    overflow: hidden;
    border: 1px solid #e5e7eb;
}

.dark-mode .content table {
    border: 1px solid #4b5563;
}

.content thead {
    background-color: #eaebec;
}

.dark-mode .content thead {
    background-color: #374151;
}

.content th {
    padding: 0.75rem 1rem;
    text-align: left;
    font-weight: 600;
    color: #374151;
    border-bottom: 1px solid #e5e7eb;
    border-right: 1px solid #e5e7eb;  
    font-size: 0.875rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

.dark-mode .content th {
    color: #f9fafb;
    border-bottom: 1px solid #4b5563;
    border-right: 1px solid #4b5563;  
}

.content th:last-child {
    border-right: none;  
}

.content td {
    padding: 0.75rem 1rem;
    border-bottom: 1px solid #e5e7eb;
    border-right: 1px solid #e5e7eb;  
    color: #6b7280;
}

.dark-mode .content td {
    color: #d1d5db;
    border-bottom: 1px solid #4b5563;
    border-right: 1px solid #4b5563;  
}

.content td:last-child {
    border-right: none;  
}

.content tbody tr {
    transition: background-color 0.15s ease-in-out;
}

.content tbody tr:hover {
    background-color: #f9fafb;
}

.dark-mode .content tbody tr:hover {
    background-color: #374151;
}

.content tbody tr:last-child td {
    border-bottom: none;
}

 
.content tbody tr:nth-child(even) {
    background-color: #f4f5f7;
}

.dark-mode .content tbody tr:nth-child(even) {
    background-color: #1f2937;
}

.dark-mode .content tbody tr:nth-child(even):hover {
    background-color: #374151;
}

 
.content code:not(pre code) {
    background-color: #f3f4f6;
    color: #dc2626;
    padding: 0.125rem 0.375rem;
    border-radius: 0.25rem;
    font-size: 0.875em;
    font-weight: 500;
    border: 1px solid #e5e7eb;
    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', 'source-code-pro', monospace;
}

.dark-mode .content code:not(pre code) {
    background-color: #224464;
    color: #f87171;
    border: 1px solid #4b5563;
}

 
.content pre {
    background-color: #224464;
    color: #f9fafb;
    padding: 1rem;
    border-radius: 0.5rem;
    overflow-x: auto;
    margin: 1.5rem 0;
    border: 1px solid #374151;
    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', 'source-code-pro', monospace;
    font-size: 0.875rem;
    line-height: 1.5;
}

.dark-mode .content pre {
    background-color: #111827;
    border: 1px solid #374151;
}

 
.content pre code {
    background: none;
    color: inherit;
    padding: 0;
    border: none;
    font-size: inherit;
    font-weight: normal;
}

 
.content pre code .keyword { color: #f472b6; }  
.content pre code .function { color: #60a5fa; }  
.content pre code .string { color: #34d399; }  
.content pre code .comment { color: #9ca3af; font-style: italic; }  
.content pre code .number { color: #fbbf24; }  
.content pre code .class { color: #c084fc; }  
.content pre code .operator { color: #93c5fd; }  

 
.content pre::-webkit-scrollbar {
    height: 6px;
}

.content pre::-webkit-scrollbar-track {
    background: #374151;
    border-radius: 0 0 0.5rem 0.5rem;
}

.content pre::-webkit-scrollbar-thumb {
    background: #6b7280;
    border-radius: 3px;
}

.content pre::-webkit-scrollbar-thumb:hover {
    background: #9ca3af;
}

 
.content h1 code:not(pre code),
.content h2 code:not(pre code),
.content h3 code:not(pre code) {
    font-size: 0.9em;
    background-color: #fef2f2;
    color: #dc2626;
}

.dark-mode .content h1 code:not(pre code),
.dark-mode .content h2 code:not(pre code),
.dark-mode .content h3 code:not(pre code) {
    background-color: #7f1d1d;
    color: #fca5a5;
}

 
.content a code:not(pre code) {
    color: inherit;
    background-color: rgba(59, 130, 246, 0.1);
}

.dark-mode .content a code:not(pre code) {
    background-color: rgba(96, 165, 250, 0.2);
}
        :root {
            --color-bg: #1a1a1a;
            --color-text: #e6e6e6;
            --color-accent: #6b7280;
            --color-link: #9ca3af;
            --color-link-hover: #d1d5db;
        }
        
        .light-mode {
            --color-bg: #f9fafb;
            --color-text: #1f2937;
            --color-accent: #6b7280;
            --color-link: #4b5563;
            --color-link-hover: #111827;
        }
        
        body {
            background-color: var(--color-bg);
            color: var(--color-text);
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
            transition: background-color 0.3s, color 0.3s;
        }
        
        a {
            color: var(--color-link);
            text-decoration: none;
            transition: color 0.2s;
        }
        
        a:hover {
            color: var(--color-link-hover);
        }
        
        .sidebar {
            position: fixed;
             
            height: 100vh;
            overflow-y: auto;
            
        }
        
        .main-content {
            margin-left: 350px;
            
             
        }
        
        .toc-container {
            position: fixed;
            right: 2rem;
            top: 2rem;
            width: 250px;
            display: none;
        }
        
        @media (min-width: 1280px) {
            .toc-container {
                display: block;
            }
        }
        
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease;
                z-index: 50;
            }
            
            .sidebar.open {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 0;
                 
            }
            
            .mobile-menu-btn {
                display: block;
                position: fixed;
                top: 1rem;
                left: 1rem;
                z-index: 100;
            }
        }
        
        .toc-link.active {
            color: var(--color-link-hover);
            font-weight: bold;
        }
        
        .social-icons a {
            margin-right: 0.5rem;
        }
        
        pre {
            background-color: rgba(107, 114, 128, 0.1);
            padding: 1rem;
            border-radius: 0.25rem;
            overflow-x: auto;
        }
        
        code {
            font-family: Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
        }
    </style>
    <script src="https://cdn.tailwindcss.com"></script>
   <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              brand: {
                50: '#eff6ff',
                100: '#dbeafe',
                500: '#0ea5e9',
                600: '#0284c7',
              },
            },
            boxShadow: {
              soft: '0 8px 24px rgba(2, 132, 199, 0.08)'
            }
          },
        },
      }
    </script>
</head>
  <body class="light-mode">
      <header>
    
  </header>
    
    <button class="mobile-menu-btn p-2 bg-gray-800 text-white rounded md:hidden">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
    </button>

    
    <aside class="sidebar border-r-4 border-sky-800  min-w-[350px] py-12 px-10 bg-gradient-to-br from-cyan-200 via-green-100 to-sky-100">
        <div class="flex flex-col items-center mb-8">
                
            
            <div class="w-24 h-24 mb-4 relative">
                <a href="/">
                <svg version="1.0" xmlns="http://www.w3.org/2000/svg"
 viewBox="0 0 550.000000 385.000000"
 preserveAspectRatio="xMidYMid meet">

<g transform="translate(0.000000,385.000000) scale(0.100000,-0.100000)"
fill="#000000" stroke="none">
<path d="M2780 3000 l0 -300 40 0 40 0 0 260 0 260 1165 0 1165 0 0 -1245 0
-1245 -1165 0 -1165 0 0 260 0 260 -40 0 -40 0 0 -300 0 -300 1245 0 1245 0 0
1325 0 1325 -1245 0 -1245 0 0 -300z"/>
<path d="M700 1975 l0 -635 145 0 145 0 0 245 0 245 383 0 c422 0 426 1 491
66 60 60 66 88 66 319 0 190 -2 214 -21 255 -25 56 -53 86 -104 113 -39 22
-49 22 -572 25 l-533 3 0 -636z m940 245 l0 -100 -325 0 -325 0 0 100 0 100
325 0 325 0 0 -100z"/>
<path d="M2320 2601 c-69 -22 -112 -58 -146 -121 -17 -31 -19 -60 -19 -260 0
-211 1 -227 22 -265 27 -51 68 -90 115 -109 32 -14 98 -16 438 -16 l400 0 0
-245 0 -245 145 0 145 0 0 536 c0 373 -3 548 -11 575 -16 50 -61 105 -112 132
-41 22 -48 22 -497 24 -250 1 -466 -2 -480 -6z m810 -381 l0 -100 -340 0 -340
0 0 100 0 100 340 0 340 0 0 -100z"/>
<path d="M3650 2607 c0 -1 99 -144 219 -317 l219 -314 -63 -91 c-34 -49 -133
-191 -219 -315 l-157 -225 172 -3 c97 -1 176 2 183 7 6 5 72 97 146 205 74
107 138 196 141 196 4 0 71 -92 149 -205 l143 -205 173 0 c96 0 174 2 174 4 0
3 -95 141 -211 308 -116 167 -214 308 -216 315 -3 7 92 151 211 322 119 170
216 312 216 315 0 3 -78 6 -174 6 l-174 0 -143 -205 c-78 -113 -145 -205 -149
-205 -3 0 -70 92 -148 205 l-143 205 -174 0 c-96 0 -175 -1 -175 -3z"/>
</g>
</svg>
</a>
            </div>

            <p class="text-xs text-center text-gray-500 max-w-[200px]">
                Профессиональное агентство контекстной рекламы с опытом более 18 лет.

            </p>
        </div>

        
        <nav class="mb-8">
          
        
            
  <nav>
    <ul>
    <li class="text-lg font-semibold">
      <a href="/">Контекстная реклама</a>
    </li>
    <li class="text-lg font-semibold">
      <a href="/analytics/">web-аналитика</a>
    </li>
    <li class="text-lg font-semibold">
      <a aria-current="true" class="ancestor" href="/posts/">Блог</a>
    </li>
    <li class="text-lg font-semibold">
      <a href="/about/">О нас</a>
    </li>
    <li class="text-lg font-semibold">
      <a href="/tags/">Категории</a>
    </li>
    <li class="text-lg font-semibold">
      <a href="/job/">Вакансии</a>
    </li>
    <li class="text-lg font-semibold">
      <a href="/tags/case/">Кейсы</a>
    </li>
    <li class="text-lg font-semibold">
      <a href="/calculators/">Калькуляторы</a>
    </li>
    <li class="text-lg font-semibold">
      <a href="/contacts/">Контакты</a>
    </li>
    </ul>
  </nav>

           

        </nav>

        
        <div class="social-icons  mt-auto">
<div>

<a href="https://t.me/your_link" target="_blank" class="inline-flex 
items-center justify-center px-3 py-3 text-white bg-[#2AABEE] font-medium text-sm rounded 
shadow-md hover:bg-[#279fd9] 
hover:shadow-lg focus:bg-[#2493c8] 
focus:shadow-lg focus:outline-none 
focus:ring-0 active:bg-[#2185b3] active:shadow-lg transition duration-150 ease-in-out">
  
     
<svg width="25px" height="25px" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" 
fill="#fff" class="bi bi-telegram pr-1">
  <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8.287 5.906c-.778.324-2.334.994-4.666 2.01-.378.15-.577.298-.595.442-.03.243.275.339.69.47l.175.055c.408.133.958.288 1.243.294.26.006.549-.1.868-.32 2.179-1.471 3.304-2.214 3.374-2.23.05-.012.12-.026.166.016.047.041.042.12.037.141-.03.129-1.227 1.241-1.846 1.817-.193.18-.33.307-.358.336a8.154 8.154 0 0 1-.188.186c-.38.366-.664.64.015 1.088.327.216.589.393.85.571.284.194.568.387.936.629.093.06.183.125.27.187.331.236.63.448.997.414.214-.02.435-.22.547-.82.265-1.417.786-4.486.906-5.751a1.426 1.426 0 0 0-.013-.315.337.337 0 0 0-.114-.217.526.526 0 0 0-.31-.093c-.3.005-.763.166-2.984 1.09z"/>
</svg>
                            
  
  Открыть в Telegram
</a>

</div>
            <div class="pt-6 flex gap-1 justify-left items-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                </svg>
                sale@p9x.ru
            </div>
        </div>
        
        
        <div class="mt-8 pt-4 text-xs text-gray-500 border-t border-gray-700">
            <p>Powered by <a href="#" class="hover:underline">Hugo</a> | Themed with <a href="#" class="hover:underline">poison</a></p>
            <p>© 2010 - 2025 Poison. All rights reserved.</p>
        </div>
    </aside>

  <main class="main-content">
 
            
            
   <div class="max-w-[1100px]">
    
    <section class="bg-white border border-gray-200  shadow-sm overflow-hidden">
      
      <div class="bg-gradient-to-b from-sky-50/60 to-transparent p-6 border-b border-gray-200">
        <h1 class="text-2xl md:text-3xl font-bold">Как создать ИИ-агент с вызовом функций и GPT-5</h1>
        <time class="block mt-2 text-gray-500" datetime="2025-11-19T23:13:09+00:00">
          
    
    November 19, 2025
        </time>

              
        <div class="not-prose backdrop-blur-sm pt-4">
          <div class="flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between">
            <div class="flex items-center gap-3">
              
                <img src="/user_02.png" class="h-20 w-20 rounded-full hue-rotate-270" alt="">
              
              <div>
                <p class="text-gray-800 font-medium">Автор: Дмитрий Иванов [Команда P9X]</p>
                <p class="text-gray-600 text-sm">~8 минут чтения</p>
              </div>
            </div>
            <div class="text-sm text-gray-600">
                <div class="tags mt-8">
      

    </div>
            </div>
          </div>
        </div>

      </div>

      
      <article class="px-6 py-6 max-w-[94ch] content">
  

        


        
     
           <h2 id="большие-языковые-модели-llms">Большие языковые модели (LLMs)</h2>
<p><strong>Большие языковые модели (LLMs)</strong> — это продвинутые системы искусственного интеллекта, построенные на основе глубоких нейронных сетей, таких как трансформеры, и обученные на огромных объёмах текста для генерации языка, похожего на человеческий. Примеры LLM включают ChatGPT, Claude, Gemini и Grok. Они могут решать множество сложных задач и используются в различных областях, таких как наука, здравоохранение, образование и финансы.</p>
<h3 id="агент-ии-расширяет-возможности-llm">Агент ИИ расширяет возможности LLM</h3>
<p>Агент ИИ расширяет возможности LLM для решения задач, выходящих за рамки их предварительно обученных знаний. LLM может написать руководство по Python на основе того, что она изучила во время обучения. Если вы попросите её забронировать рейс, потребуется доступ к вашему календарю, веб-поиск и возможность выполнять действия, которые выходят за рамки предварительно обученных знаний LLM.</p>
<h3 id="примеры-действий">Примеры действий</h3>
<ul>
<li><strong>Прогноз погоды:</strong> LLM подключается к инструменту веб-поиска, чтобы получить последний прогноз погоды.</li>
<li><strong>Агент по бронированию:</strong> агент ИИ может проверить календарь пользователя, выполнить веб-поиск для посещения сайта бронирования, такого как Expedia, чтобы найти доступные варианты перелёта и отелей, представить их пользователю для подтверждения и завершить бронирование от имени пользователя.</li>
</ul>
<h3 id="как-работает-агент-ии">Как работает агент ИИ</h3>
<p>Агенты ИИ формируют систему, которая использует большую языковую модель для планирования, рассуждений и выполнения действий для взаимодействия со своей средой с помощью инструментов, предложенных моделью для решения конкретной задачи.</p>
<h3 id="базовая-структура-агента-ии">Базовая структура агента ИИ</h3>
<ul>
<li><strong>Большая языковая модель (LLM):</strong> LLM — это «мозг» агента ИИ. Она принимает запрос пользователя, планирует и рассуждает над запросом, разбивает проблему на шаги, которые определяют, какие инструменты следует использовать для выполнения задачи.</li>
<li><strong>Инструмент:</strong> это структура, которую агент использует для выполнения действия на основе плана и рассуждений, полученных от большой языковой модели. Например, если вы попросите LLM забронировать столик в ресторане, возможными инструментами будут календарь для проверки вашей доступности и инструмент веб-поиска для доступа к веб-сайту ресторана и бронирования столика.</li>
</ul>
<h3 id="иллюстративное-принятие-решений-агентом-по-бронированию">Иллюстративное принятие решений агентом по бронированию</h3>
<p>Агенты ИИ могут получать доступ к различным инструментам в зависимости от задачи. Инструментом может быть хранилище данных, такое как база данных. Например, агент поддержки клиентов может получить доступ к учётным данным клиента и истории покупок и решить, когда извлечь эту информацию, чтобы помочь решить проблему.</p>
<p>Агенты ИИ используются для решения широкого спектра задач, и существует множество мощных агентов. Кодовые агенты, особенно агентские IDE, такие как Cursor, Windsurf и GitHub Copilot, помогают инженерам писать и отлаживать код быстрее и создавать проекты быстрее. Агенты CLI, такие как Claude Code и Codex CLI, могут взаимодействовать с рабочим столом пользователя и терминалом для выполнения задач кодирования. ChatGPT поддерживает агентов, которые могут выполнять действия, такие как бронирование мест от имени пользователя. Агенты также интегрированы в рабочие процессы поддержки клиентов для общения с клиентами и решения их проблем.</p>
<h3 id="вызов-функций">Вызов функций</h3>
<p>Вызов функций — это метод подключения большой языковой модели (LLM) к внешним инструментам, таким как API или базы данных. Он используется при создании агентов ИИ для подключения LLM к инструментам. В вызове функций каждый инструмент определяется как кодовая функция (например, API погоды для получения последнего прогноза) вместе с JSON-схемой, которая определяет параметры функции и инструктирует LLM, когда и как вызывать функцию для выполнения задачи.</p>
<h3 id="базовая-структура-агента-веб-поиска">Базовая структура агента веб-поиска</h3>
<p>Основная логика агента веб-поиска:</p>
<ul>
<li>Определить функцию для обработки веб-поиска.</li>
<li>Определить пользовательские инструкции, которые направляют большую языковую модель в определении, когда вызывать функцию веб-поиска на основе запроса. Например, если запрос касается текущей погоды, агент веб-поиска распознает необходимость поиска в интернете для получения последних отчётов о погоде. Однако если запрос просит написать руководство по языку программирования, например, по Python, что-то, что LLM может ответить на основе предварительно обученных знаний, она не будет вызывать функцию веб-поиска, а ответит напрямую.</li>
</ul>
<h3 id="предварительные-требования">Предварительные требования</h3>
<p><strong>Создайте учётную запись OpenAI и сгенерируйте ключ API</strong></p>
<ol>
<li>Создайте учётную запись OpenAI, если у вас её нет.</li>
<li>Сгенерируйте ключ API.</li>
</ol>
<p><strong>Настройка и активация среды</strong></p>
<pre tabindex="0"><code>python3 -m venv env
source env/bin/activate
</code></pre><p><strong>Экспорт ключа API OpenAI</strong></p>
<pre tabindex="0"><code>export OPENAI_API_KEY=&#34;Your Openai API Key&#34;
</code></pre><p><strong>Настройка Tavily для веб-поиска</strong></p>
<p>Tavily — это специализированный инструмент веб-поиска для агентов ИИ. Создайте учётную запись на Tavily.com, и после настройки вашего профиля будет сгенерирован API-ключ, который вы можете скопировать в свою среду. Новым учётным записям предоставляется 1000 бесплатных кредитов, которые можно использовать для до 1000 веб-поисков.</p>
<p><strong>Экспорт ключа API Tavily</strong></p>
<pre tabindex="0"><code>export TAVILY_API_KEY=&#34;Your Tavily API Key&#34;
</code></pre><p><strong>Установка пакетов</strong></p>
<pre tabindex="0"><code>pip3 install openai
pip3 install tavily-python
</code></pre><h3 id="создание-агента-веб-поиска-с-вызовом-функций-шаг-за-шагом">Создание агента веб-поиска с вызовом функций шаг за шагом</h3>
<p><strong>Шаг 1: создание функции веб-поиска с помощью Tavily</strong></p>
<p>Функция веб-поиска реализована с использованием Tavily, которая служит инструментом для вызова функций в агенте веб-поиска.</p>
<pre tabindex="0"><code>from tavily import TavilyClient
import os

tavily = TavilyClient(api_key=os.getenv(&#34;TAVILY_API_KEY&#34;))

def web_search(query: str, num_results: int = 10):
    try:
        result = tavily.search(
            query=query,
            search_depth=&#34;basic&#34;,
            max_results=num_results,
            include_answer=False,
            include_raw_content=False,
            include_images=False
        )

        results = result.get(&#34;results&#34;, [])

        return {
            &#34;query&#34;: query,
            &#34;results&#34;: results,
            &#34;sources&#34;: [
                {&#34;title&#34;: r.get(&#34;title&#34;, &#34;&#34;), &#34;url&#34;: r.get(&#34;url&#34;, &#34;&#34;)}
                for r in results
            ]
        }

    except Exception as e:
        return {
            &#34;error&#34;: f&#34;Search error: {e}&#34;,
            &#34;query&#34;: query,
            &#34;results&#34;: [],
            &#34;sources&#34;: [],
        }
</code></pre><p><strong>Шаг 2: создание схемы инструмента</strong></p>
<p>Схема инструмента определяет пользовательские инструкции для ИИ-модели о том, когда она должна вызывать инструмент, в данном случае инструмент, который будет использоваться в функции веб-поиска. Она также определяет условия и действия, которые должны быть предприняты, когда модель вызывает инструмент.</p>
<pre tabindex="0"><code>tool_schema = [
    {
        &#34;type&#34;: &#34;function&#34;,
        &#34;name&#34;: &#34;web_search&#34;,
        &#34;description&#34;: &#34;&#34;&#34;Execute a web search to fetch up to date information. Synthesize a concise, 
        self-contained answer from the content of the results of the visited pages.
        Fetch pages, extract text, and provide the best available result while citing 1-3 sources (title + URL). 
        If sources conflict, surface the uncertainty and prefer the most recent evidence.
        &#34;&#34;&#34;,
        &#34;strict&#34;: True,
        &#34;parameters&#34;: {
            &#34;type&#34;: &#34;object&#34;,
            &#34;properties&#34;: {
                &#34;query&#34;: {
                    &#34;type&#34;: &#34;string&#34;,
                    &#34;description&#34;: &#34;Query to be searched on the web.&#34;,
                },
            },
            &#34;required&#34;: [&#34;query&#34;],
            &#34;additionalProperties&#34;: False
        },
    },
]
</code></pre><p><strong>Шаг 3: создание агента веб-поиска с помощью GPT-5 и вызова функций</strong></p>
<p>Наконец, я создам агента, с которым можно будет общаться, который сможет искать в интернете, когда ему понадобится актуальная информация. Я буду использовать GPT-5-mini, быструю и точную модель от OpenAI, вместе с вызовом функций для вызова схемы инструмента и уже определённой функции веб-поиска.</p>
<pre tabindex="0"><code>from datetime import datetime, timezone
import json
from openai import OpenAI
import os
from tavily import TavilyClient

tavily = TavilyClient(api_key=os.getenv(&#34;TAVILY_API_KEY&#34;))

def web_search(query: str, num_results: int = 10):
    try:
        result = tavily.search(
            query=query,
            search_depth=&#34;basic&#34;,
            max_results=num_results,
            include_answer=False,
            include_raw_content=False,
            include_images=False
        )

        results = result.get(&#34;results&#34;, [])

        return {
            &#34;query&#34;: query,
            &#34;results&#34;: results,
            &#34;sources&#34;: [
                {&#34;title&#34;: r.get(&#34;title&#34;, &#34;&#34;), &#34;url&#34;: r.get(&#34;url&#34;, &#34;&#34;)}
                for r in results
            ]
        }

    except Exception as e:
        return {
            &#34;error&#34;: f&#34;Search error: {e}&#34;,
            &#34;query&#34;: query,
            &#34;results&#34;: [],
            &#34;sources&#34;: [],
        }

tool_schema = [
    {
        &#34;type&#34;: &#34;function&#34;,
        &#34;name&#34;: &#34;web_search&#34;,
        &#34;description&#34;: &#34;&#34;&#34;Execute a web search to fetch up to date information. Synthesize a concise, 
        self-contained answer from the content of the results of the visited pages.
        Fetch pages, extract text, and provide the best available result while citing 1-3 sources (title + URL). 
        If sources conflict, surface the uncertainty and prefer the most recent evidence.
        &#34;&#34;&#34;,
        &#34;strict&#34;: True,
        &#34;parameters&#34;: {
            &#34;type&#34;: &#34;object&#34;,
            &#34;properties&#34;: {
                &#34;query&#34;: {
                    &#34;type&#34;: &#34;string&#34;,
                    &#34;description&#34;: &#34;Query to be searched on the web.&#34;,
                },
            },
            &#34;required&#34;: [&#34;query&#34;],
            &#34;additionalProperties&#34;: False
        },
    },
]

client = OpenAI(api_key=os.getenv(&#34;OPENAI_API_KEY&#34;))

prev_response_id = None

tool_results = []

while True:

    if len(tool_results) == 0:
        user_message = input(&#34;User: &#34;)

        &#34;&#34;&#34; commands for exiting chat &#34;&#34;&#34;
        if isinstance(user_message, str) and user_message.strip().lower() in {&#34;exit&#34;, &#34;q&#34;}:
            print(&#34;Exiting chat. Goodbye!&#34;)
            break

    else:
        user_message = tool_results.copy()

        tool_results = []

    today_date = datetime.now(timezone.utc).date().isoformat()

    response = client.responses.create(
        model = &#34;gpt-5-mini&#34;,
        input = user_message,
        instructions=f&#34;Current date is {today_date}.&#34;,
        tools = tool_schema,
        previous_response_id=prev_response_id,
        text = {&#34;verbosity&#34;: &#34;low&#34;},
        reasoning={
            &#34;effort&#34;: &#34;low&#34;,
        },
        store=True,
        )

    prev_response_id = response.id

    for output in response.output:
        if output.type == &#34;reasoning&#34;:
            print(&#34;Assistant: &#34;,&#34;Reasoning ....&#34;)

            for reasoning_summary in output.summary:
                print(&#34;Assistant: &#34;,reasoning_summary)

        elif output.type == &#34;message&#34;:
            for item in output.content:
                print(&#34;Assistant: &#34;,item.text)

        elif output.type == &#34;function_call&#34;:
            function_name = globals().get(output.name)

            args = json.loads(output.arguments)
            function_response = function_name(**args)

            tool_results.append(
                {
                    &#34;type&#34;: &#34;function_call_output&#34;,
                    &#34;call_id&#34;: output.call_id,
                    &#34;output&#34;: json.dumps(function_response)
                }
            )

Когда вы запустите код, вы сможете легко общаться с агентом, чтобы задавать вопросы, требующие актуальной информации, например, о текущей погоде или последних выпусках продуктов. Агент отвечает актуальной информацией вместе с соответствующими источниками из интернета.

### Заключение

В этом посте я объяснил, как работает агент ИИ и как он расширяет возможности большой языковой модели для взаимодействия со своей средой, выполнения действий и решения задач с помощью инструментов. Я также объяснил вызов функций и то, как он позволяет LLM вызывать инструменты. Я продемонстрировал, как создать схему инструмента для вызова функций, которая определяет, когда и как LLM должна вызывать инструмент для выполнения действия. Я определил функцию веб-поиска с помощью Tavily для получения информации из интернета и затем показал шаг за шагом, как создать агента веб-поиска с помощью вызова функций и GPT-5-mini в качестве LLM. В итоге мы создали агента веб-поиска, способного получать актуальную информацию из интернета для ответа на запросы пользователей.
</code></pre>
        

      </article>
    </section>
  </div>



          
<footer class="px-6 py-12 bg-sky-950 text-white/50">
     <div class="inset-0 bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900"></div>
      <div class="relative">
 
          <div class="border-t border-white/10"></div>

          
          <div class="mt-6 flex flex-col md:flex-row items-center justify-between gap-4">
            <p class="text-sm text-slate-400">© <span id="year"></span>P9X.ru 2010 - 2025г. услуги интернет маркетинга</p>
            <div class="flex items-center gap-4 text-slate-400 text-sm">
              <a href="#" class="hover:text-white transition">Документы</a>
              <a href="#" class="hover:text-white transition">Служба поддержки</a>
              <a href="#" class="hover:text-white transition">Статус</a>
            </div>
          </div>      
      </div>


<script type="text/javascript">
    (function(m,e,t,r,i,k,a){
        m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();
        for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
        k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
    })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=105149615', 'ym');

    ym(105149615, 'init', {ssr:true, webvisor:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true});
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/105149615" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

  </footer>
  </main>          

    <script>

        
        
        const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
        const sidebar = document.querySelector('.sidebar');
        
        mobileMenuBtn.addEventListener('click', () => {
            sidebar.classList.toggle('open');
        });
        
        
        const observerOptions = {
            root: null,
            rootMargin: '0px',
            threshold: 0.5
        };
        
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                const id = entry.target.getAttribute('id');
                if (entry.isIntersecting) {
                    document.querySelectorAll(`.toc-link[href="#${id}"]`).forEach(link => {
                        link.classList.add('active');
                    });
                } else {
                    document.querySelectorAll(`.toc-link[href="#${id}"]`).forEach(link => {
                        link.classList.remove('active');
                    });
                }
            });
        }, observerOptions);
        
        
        document.querySelectorAll('h2[id]').forEach(heading => {
            observer.observe(heading);
        });
    </script>



</body>
</html>
