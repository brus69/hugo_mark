<!DOCTYPE html>
<html lang="ru" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>Освоение моделирования маркетингового комплекса на Python | На пути к науке о данных | Агентство контекстной рекламы</title>
<meta name="description" content="">
<meta name="yandex-verification" content="242f5a0ee52d5836" />

<link rel="icon" type="image/x-icon" href="http://localhost:1313/favicon.ico">

    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
 <style>
  .content h1 { 
        font-size: 1.875rem; 
        font-weight: bold; 
        margin-bottom: 1rem; 
    }
    .content h2 { 
        font-size: 1.5rem; 
        font-weight: 600; 
        margin-bottom: 0.75rem; 
    }
    .content h3 { 
        font-size: 1.25rem; 
        font-weight: 500; 
        margin-bottom: 0.5rem; 
    }
    .content p { 
        margin-bottom: 1rem; 
    }
    .content ul { 
        list-style-type: disc; 
        list-style-position: inside; 
        margin-bottom: 1rem; 
    }
    .content ol { 
        list-style-type: decimal; 
        list-style-position: inside; 
        margin-bottom: 1rem; 
    }
    .content a { 
        color: #2563eb; 
    }
    .content a:hover { 
        color: #1e40af; 
    }
    .content blockquote { 
        border-left: 4px solid #d1d5db; 
        padding-left: 1rem; 
        font-style: italic; 
    }

    
.content table {
    width: 100%;
    border-collapse: collapse;
    margin: 1.5rem 0;
    font-size: 0.875rem;
    box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
    border-radius: 0.5rem;
    overflow: hidden;
    border: 1px solid #e5e7eb;
}

.dark-mode .content table {
    border: 1px solid #4b5563;
}

.content thead {
    background-color: #eaebec;
}

.dark-mode .content thead {
    background-color: #374151;
}

.content th {
    padding: 0.75rem 1rem;
    text-align: left;
    font-weight: 600;
    color: #374151;
    border-bottom: 1px solid #e5e7eb;
    border-right: 1px solid #e5e7eb;  
    font-size: 0.875rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

.dark-mode .content th {
    color: #f9fafb;
    border-bottom: 1px solid #4b5563;
    border-right: 1px solid #4b5563;  
}

.content th:last-child {
    border-right: none;  
}

.content td {
    padding: 0.75rem 1rem;
    border-bottom: 1px solid #e5e7eb;
    border-right: 1px solid #e5e7eb;  
    color: #6b7280;
}

.dark-mode .content td {
    color: #d1d5db;
    border-bottom: 1px solid #4b5563;
    border-right: 1px solid #4b5563;  
}

.content td:last-child {
    border-right: none;  
}

.content tbody tr {
    transition: background-color 0.15s ease-in-out;
}

.content tbody tr:hover {
    background-color: #f9fafb;
}

.dark-mode .content tbody tr:hover {
    background-color: #374151;
}

.content tbody tr:last-child td {
    border-bottom: none;
}

 
.content tbody tr:nth-child(even) {
    background-color: #f4f5f7;
}

.dark-mode .content tbody tr:nth-child(even) {
    background-color: #1f2937;
}

.dark-mode .content tbody tr:nth-child(even):hover {
    background-color: #374151;
}

 
.content code:not(pre code) {
    background-color: #f3f4f6;
    color: #dc2626;
    padding: 0.125rem 0.375rem;
    border-radius: 0.25rem;
    font-size: 0.875em;
    font-weight: 500;
    border: 1px solid #e5e7eb;
    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', 'source-code-pro', monospace;
}

.dark-mode .content code:not(pre code) {
    background-color: #224464;
    color: #f87171;
    border: 1px solid #4b5563;
}

 
.content pre {
    background-color: #224464;
    color: #f9fafb;
    padding: 1rem;
    border-radius: 0.5rem;
    overflow-x: auto;
    margin: 1.5rem 0;
    border: 1px solid #374151;
    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', 'source-code-pro', monospace;
    font-size: 0.875rem;
    line-height: 1.5;
}

.dark-mode .content pre {
    background-color: #111827;
    border: 1px solid #374151;
}

 
.content pre code {
    background: none;
    color: inherit;
    padding: 0;
    border: none;
    font-size: inherit;
    font-weight: normal;
}

 
.content pre code .keyword { color: #f472b6; }  
.content pre code .function { color: #60a5fa; }  
.content pre code .string { color: #34d399; }  
.content pre code .comment { color: #9ca3af; font-style: italic; }  
.content pre code .number { color: #fbbf24; }  
.content pre code .class { color: #c084fc; }  
.content pre code .operator { color: #93c5fd; }  

 
.content pre::-webkit-scrollbar {
    height: 6px;
}

.content pre::-webkit-scrollbar-track {
    background: #374151;
    border-radius: 0 0 0.5rem 0.5rem;
}

.content pre::-webkit-scrollbar-thumb {
    background: #6b7280;
    border-radius: 3px;
}

.content pre::-webkit-scrollbar-thumb:hover {
    background: #9ca3af;
}

 
.content h1 code:not(pre code),
.content h2 code:not(pre code),
.content h3 code:not(pre code) {
    font-size: 0.9em;
    background-color: #fef2f2;
    color: #dc2626;
}

.dark-mode .content h1 code:not(pre code),
.dark-mode .content h2 code:not(pre code),
.dark-mode .content h3 code:not(pre code) {
    background-color: #7f1d1d;
    color: #fca5a5;
}

 
.content a code:not(pre code) {
    color: inherit;
    background-color: rgba(59, 130, 246, 0.1);
}

.dark-mode .content a code:not(pre code) {
    background-color: rgba(96, 165, 250, 0.2);
}
        :root {
            --color-bg: #1a1a1a;
            --color-text: #e6e6e6;
            --color-accent: #6b7280;
            --color-link: #9ca3af;
            --color-link-hover: #d1d5db;
        }
        
        .light-mode {
            --color-bg: #f9fafb;
            --color-text: #1f2937;
            --color-accent: #6b7280;
            --color-link: #4b5563;
            --color-link-hover: #111827;
        }
        
        body {
            background-color: var(--color-bg);
            color: var(--color-text);
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
            transition: background-color 0.3s, color 0.3s;
        }
        
        a {
            color: var(--color-link);
            text-decoration: none;
            transition: color 0.2s;
        }
        
        a:hover {
            color: var(--color-link-hover);
        }
        
        .sidebar {
            position: fixed;
             
            height: 100vh;
            overflow-y: auto;
            
        }
        
        .main-content {
            margin-left: 350px;
            
             
        }
        
        .toc-container {
            position: fixed;
            right: 2rem;
            top: 2rem;
            width: 250px;
            display: none;
        }
        
        @media (min-width: 1280px) {
            .toc-container {
                display: block;
            }
        }
        
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease;
                z-index: 50;
            }
            
            .sidebar.open {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 0;
                 
            }
            
            .mobile-menu-btn {
                display: block;
                position: fixed;
                top: 1rem;
                left: 1rem;
                z-index: 100;
            }
        }
        
        .toc-link.active {
            color: var(--color-link-hover);
            font-weight: bold;
        }
        
        .social-icons a {
            margin-right: 0.5rem;
        }
        
        pre {
            background-color: rgba(107, 114, 128, 0.1);
            padding: 1rem;
            border-radius: 0.25rem;
            overflow-x: auto;
        }
        
        code {
            font-family: Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
        }
    </style>
</head>
  <body class="light-mode">
      <header>
    
  </header>
    
    <button class="mobile-menu-btn p-2 bg-gray-800 text-white rounded md:hidden">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
    </button>

    
    <aside class="sidebar border-r-4 border-sky-800  min-w-[350px] py-12 px-10 bg-gradient-to-br from-cyan-200 via-green-100 to-sky-100">
        <div class="flex flex-col items-center mb-8">
                
            
            <div class="w-24 h-24 mb-4 relative">
                <a href="/">
                <svg version="1.0" xmlns="http://www.w3.org/2000/svg"
 viewBox="0 0 550.000000 385.000000"
 preserveAspectRatio="xMidYMid meet">

<g transform="translate(0.000000,385.000000) scale(0.100000,-0.100000)"
fill="#000000" stroke="none">
<path d="M2780 3000 l0 -300 40 0 40 0 0 260 0 260 1165 0 1165 0 0 -1245 0
-1245 -1165 0 -1165 0 0 260 0 260 -40 0 -40 0 0 -300 0 -300 1245 0 1245 0 0
1325 0 1325 -1245 0 -1245 0 0 -300z"/>
<path d="M700 1975 l0 -635 145 0 145 0 0 245 0 245 383 0 c422 0 426 1 491
66 60 60 66 88 66 319 0 190 -2 214 -21 255 -25 56 -53 86 -104 113 -39 22
-49 22 -572 25 l-533 3 0 -636z m940 245 l0 -100 -325 0 -325 0 0 100 0 100
325 0 325 0 0 -100z"/>
<path d="M2320 2601 c-69 -22 -112 -58 -146 -121 -17 -31 -19 -60 -19 -260 0
-211 1 -227 22 -265 27 -51 68 -90 115 -109 32 -14 98 -16 438 -16 l400 0 0
-245 0 -245 145 0 145 0 0 536 c0 373 -3 548 -11 575 -16 50 -61 105 -112 132
-41 22 -48 22 -497 24 -250 1 -466 -2 -480 -6z m810 -381 l0 -100 -340 0 -340
0 0 100 0 100 340 0 340 0 0 -100z"/>
<path d="M3650 2607 c0 -1 99 -144 219 -317 l219 -314 -63 -91 c-34 -49 -133
-191 -219 -315 l-157 -225 172 -3 c97 -1 176 2 183 7 6 5 72 97 146 205 74
107 138 196 141 196 4 0 71 -92 149 -205 l143 -205 173 0 c96 0 174 2 174 4 0
3 -95 141 -211 308 -116 167 -214 308 -216 315 -3 7 92 151 211 322 119 170
216 312 216 315 0 3 -78 6 -174 6 l-174 0 -143 -205 c-78 -113 -145 -205 -149
-205 -3 0 -70 92 -148 205 l-143 205 -174 0 c-96 0 -175 -1 -175 -3z"/>
</g>
</svg>
</a>
            </div>

            <p class="text-xs text-center text-gray-500 max-w-[200px]">
                Профессиональное агентство контекстной рекламы с опытом более 18 лет.

            </p>
        </div>

        
        <nav class="mb-8">
          
        
            
  <nav>
    <ul>
    <li class="text-lg font-semibold">
      <a href="/">Контекстная реклама</a>
    </li>
    <li class="text-lg font-semibold">
      <a href="/analytics/">web-аналитика</a>
    </li>
    <li class="text-lg font-semibold">
      <a aria-current="true" class="ancestor" href="/posts/">Блог</a>
    </li>
    <li class="text-lg font-semibold">
      <a href="/about/">О нас</a>
    </li>
    <li class="text-lg font-semibold">
      <a href="/tags/">Категории</a>
    </li>
    <li class="text-lg font-semibold">
      <a href="/job/">Вакансии</a>
    </li>
    <li class="text-lg font-semibold">
      <a href="/tags/">Кейсы</a>
    </li>
    <li class="text-lg font-semibold">
      <a href="/calculators/">Калькуляторы</a>
    </li>
    <li class="text-lg font-semibold">
      <a href="/contacts/">Контакты</a>
    </li>
    </ul>
  </nav>

           

        </nav>

        
        <div class="social-icons  mt-auto">
<div>

<a href="https://t.me/your_link" target="_blank" class="inline-flex 
items-center justify-center px-3 py-3 text-white bg-[#2AABEE] font-medium text-sm rounded 
shadow-md hover:bg-[#279fd9] 
hover:shadow-lg focus:bg-[#2493c8] 
focus:shadow-lg focus:outline-none 
focus:ring-0 active:bg-[#2185b3] active:shadow-lg transition duration-150 ease-in-out">
  
     
<svg width="25px" height="25px" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" 
fill="#fff" class="bi bi-telegram pr-1">
  <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8.287 5.906c-.778.324-2.334.994-4.666 2.01-.378.15-.577.298-.595.442-.03.243.275.339.69.47l.175.055c.408.133.958.288 1.243.294.26.006.549-.1.868-.32 2.179-1.471 3.304-2.214 3.374-2.23.05-.012.12-.026.166.016.047.041.042.12.037.141-.03.129-1.227 1.241-1.846 1.817-.193.18-.33.307-.358.336a8.154 8.154 0 0 1-.188.186c-.38.366-.664.64.015 1.088.327.216.589.393.85.571.284.194.568.387.936.629.093.06.183.125.27.187.331.236.63.448.997.414.214-.02.435-.22.547-.82.265-1.417.786-4.486.906-5.751a1.426 1.426 0 0 0-.013-.315.337.337 0 0 0-.114-.217.526.526 0 0 0-.31-.093c-.3.005-.763.166-2.984 1.09z"/>
</svg>
                            
  
  Открыть в Telegram
</a>

</div>
            <div class="pt-6 flex gap-1 justify-left items-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                </svg>
                sale@p9x.ru
            </div>
        </div>
        
        
        <div class="mt-8 pt-4 text-xs text-gray-500 border-t border-gray-700">
            <p>Powered by <a href="#" class="hover:underline">Hugo</a> | Themed with <a href="#" class="hover:underline">poison</a></p>
            <p>© 2010 - 2025 Poison. All rights reserved.</p>
        </div>
    </aside>

  <main class="main-content bg-white">
 
            
            
  <article class="prose prose-lg py-8 px-4 max-w-[1200px]">
    <h1 class="text-2xl font-bold mb-4">
            Освоение моделирования маркетингового Комплекса на Python
    </h1>

    
    
    <time class="block mb-6 text-gray-500" datetime="2025-11-19T22:09:56&#43;00:00">November 19, 2025</time>

    <div class="content mb-8 ">
      <h3 id="что-представляет-собой-эта-серия-статей">Что представляет собой эта серия статей?</h3>
<p>Добро пожаловать к первой части моей серии статей о моделировании маркетингового микса (МММ), практическом руководстве, которое поможет вам освоить МММ. В этой серии мы рассмотрим ключевые темы, такие как обучение модели, валидация, калибровка и оптимизация бюджета, используя мощный пакет Python <strong>pymc-marketing</strong>. Независимо от того, являетесь ли вы новичком в МММ или хотите отточить свои навыки, эта серия предоставит вам практические инструменты и идеи для улучшения ваших маркетинговых стратегий.</p>
<h3 id="введение">Введение</h3>
<p>В этой статье мы начнём с краткого обзора байесовского МММ, включая следующие темы:</p>
<ul>
<li>Какие открытые пакеты мы можем использовать?</li>
<li>Что такое байесовский МММ?</li>
<li>Что такое байесовские априорные значения?</li>
<li>Разумно ли использовать априорные значения по умолчанию в <strong>pymc-marketing</strong>?</li>
</ul>
<p>Затем мы перейдём к пошаговому руководству по Python, используя пакет <strong>pymc-marketing</strong>, углубляясь в следующие области:</p>
<ul>
<li>Моделирование данных.</li>
<li>Обучение модели.</li>
<li>Валидация модели.</li>
<li>Восстановление параметров.</li>
</ul>
<p>Полный блокнот можно найти здесь:</p>
<blockquote>
<p><strong>pymc_marketing/notebooks/1. training marketing mix models (MMM) in
python.ipynb at main ·…</strong></p>
</blockquote>
<h3 id="10-фон-ммм">1.0 Фон МММ</h3>
<p>Давайте начнём с краткого обзора моделирования маркетингового микса (МММ). Мы рассмотрим различные доступные пакеты с открытым исходным кодом и углубимся в принципы байесовского МММ, включая концепцию априорных значений. Наконец, мы оценим априорные значения по умолчанию, используемые в <strong>pymc-marketing</strong>, чтобы определить их пригодность и эффективность.</p>
<h4 id="11-какие-открытые-пакеты-мы-можем-использовать">1.1 Какие открытые пакеты мы можем использовать?</h4>
<p>Когда дело доходит до МММ, мы можем использовать несколько пакетов с открытым исходным кодом:</p>
<ol>
<li><strong>Python Совместимость</strong>: в отличие от Robyn, который доступен только в R, pymc-marketing ориентирован на более широкую аудиторию, предпочитающую работать в Python.</li>
<li><strong>Текущая доступность</strong>: Meridian ещё не выпущен (по состоянию на 23 сентября 2024 года), что делает pymc-marketing более доступным вариантом прямо сейчас.</li>
<li><strong>Будущие соображения</strong>: LightweightMMM будет выведен из эксплуатации после запуска Meridian, что ещё больше укрепит необходимость в надёжной альтернативе.</li>
<li><strong>Активное развитие</strong>: pymc-marketing постоянно совершенствуется благодаря обширному сообществу участников, что обеспечивает его актуальность новыми функциями и улучшениями.</li>
</ol>
<p>Вы можете ознакомиться с пакетом pymc-marketing здесь, они предлагают несколько замечательных ноутбуков, чтобы проиллюстрировать некоторые функции пакета:</p>
<blockquote>
<p><strong>How-to – pymc-marketing 0.9.0 documentation</strong></p>
</blockquote>
<h4 id="12-что-такое-байесовский-ммм">1.2 Что такое байесовский МММ?</h4>
<p>Вы заметите, что 3 из 4 выделенных выше пакетов используют байесовский подход. Давайте потратим немного времени, чтобы понять, как выглядит байесовский МММ! Для новичков байесовский анализ — это своего рода кроличья нора, но мы можем разбить его на 5 ключевых моментов:</p>
<ol>
<li><strong>Теорема Байеса</strong> — в байесовском МММ теорема Байеса используется для обновления наших представлений о том, как маркетинговые каналы влияют на продажи, по мере сбора новых данных.</li>
<li><strong>P(θ)</strong> — <strong>Априорные значения</strong> представляют наши первоначальные представления о параметрах в модели, таких как влияние расходов на ТВ на продажи.</li>
<li><strong>P(Data | θ)</strong> — <strong>Функция правдоподобия</strong>, которая отражает вероятность наблюдения данных о продажах при определённых уровнях маркетинговых вложений.</li>
<li><strong>P(θ | Data)</strong> — <strong>Апостериорное значение</strong> — это то, что нас в конечном итоге интересует в байесовском МММ — это наше обновлённое представление о том, как различные маркетинговые каналы влияют на продажи после объединения данных и наших априорных предположений.</li>
<li><strong>Выборка</strong> — поскольку байесовский МММ включает в себя сложные модели с несколькими параметрами (например, адстоком, насыщением, эффектами маркетинговых каналов, контрольными эффектами и т. д.), вычисление апостериорного значения напрямую может быть затруднено. MCMC (Markov Chain Monte Carlo) позволяет нам аппроксимировать апостериорное значение, генерируя выборки из распределения каждого параметра.</li>
</ol>
<h4 id="13-что-такое-байесовские-априорные-значения">1.3 Что такое байесовские априорные значения?</h4>
<p>Байесовские априорные значения предоставляются в виде вероятностных распределений. Вместо того чтобы присваивать параметру фиксированное значение, мы предоставляем диапазон потенциальных значений вместе с вероятностью того, что каждое значение является истинным.</p>
<p>Общие распределения, используемые для априорных значений:</p>
<ul>
<li><strong>Нормальное</strong>: для параметров, где мы ожидаем, что значения будут группироваться вокруг среднего.</li>
<li><strong>Полунормальное</strong>: для параметров, где мы хотим обеспечить положительность.</li>
<li><strong>Бета</strong>: для параметров, которые ограничены между 0 и 1.</li>
<li><strong>Гамма</strong>: для параметров, которые являются положительными и асимметричными.</li>
</ul>
<p>Вы можете услышать термин «информативные априорные значения». В идеале мы предоставляем их на основе экспертных знаний или рандомизированных экспериментов. Однако, когда это невозможно, мы можем использовать неинформативные априорные значения, которые распределяют вероятность по широкому диапазону значений.</p>
<h4 id="14-разумно-ли-использовать-априорные-значения-по-умолчанию-в-pymc-marketing">1.4 Разумно ли использовать априорные значения по умолчанию в pymc-marketing?</h4>
<p>При использовании пакета <strong>pymc-marketing</strong> априорные значения по умолчанию разработаны так, чтобы быть слабо информативными, что означает, что они предоставляют общие рекомендации, не будучи слишком конкретными. Они направляют модель, не ограничивая её слишком сильно. Этот баланс обеспечивает, что априорные значения направляют модель, не затмевая данные.</p>
<p>Чтобы построить надёжные модели, важно понимать априорные значения по умолчанию, а не использовать их вслепую. В следующих разделах мы рассмотрим различные априорные значения, используемые в <strong>pymc-marketing</strong>, и объясним, почему выбор по умолчанию является разумным для моделей маркетингового микса.</p>
<h3 id="141-адсток-альфа">1.4.1 Адсток альфа</h3>
<p>Адсток отражает идею о том, что влияние маркетинговой активности задерживается и накапливается с течением времени. <strong>Альфа адстока (скорость затухания)</strong> контролирует, насколько быстро эффект затухает с течением времени, определяя, как долго влияние маркетинговой активности продолжает влиять на продажи.</p>
<p>Для адстока альфа используется бета-распределение. Давайте сначала визуализируем бета-распределение:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>alpha <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>beta_param <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>x1 <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">100</span>)
</span></span><span style="display:flex;"><span>y1 <span style="color:#f92672">=</span> beta<span style="color:#f92672">.</span>pdf(x1, alpha, beta_param)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(x1, y1, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;blue&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>fill_between(x1, y1, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;blue&#39;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.3</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Geometric Adstock: Beta distribution (alpha=1, beta=3)&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Adstock alpha&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Probability density&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>grid(<span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p>Мы обычно ограничиваем значения адстока альфа между 0 и 1, что делает бета-распределение разумным выбором.</p>
<h3 id="142-сатурация-ламда">1.4.2 Сатурация ламда</h3>
<p>По мере увеличения расходов на маркетинг их дополнительное влияние на продажи постепенно снижается — это известно как насыщение. <strong>Сатурация ламда</strong> контролирует крутизну кривой насыщения, определяя, насколько быстро наступает убывающая отдача.</p>
<p>Для сатурации ламда используется гамма-распределение. Давайте начнём с понимания того, как выглядит гамма-распределение:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>alpha <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>beta <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>x2 <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">1000</span>)
</span></span><span style="display:flex;"><span>y2 <span style="color:#f92672">=</span> gamma<span style="color:#f92672">.</span>pdf(x2, alpha, scale<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span><span style="color:#f92672">/</span>beta)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">6</span>))
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(x2, y2, <span style="color:#e6db74">&#39;b-&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>fill_between(x2, y2, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.2</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;blue&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Logistic Saturation: Gamma Distribution (alpha=3, beta=1)&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Saturation lamda&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Probability density&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>grid(<span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><h3 id="143-сатурация-бета">1.4.3 Сатурация бета</h3>
<p>Сатурация бета соответствует коэффициенту маркетингового канала, измеряющему влияние расходов на маркетинг.</p>
<p>Для сатурации бета используется полунормальное распределение, поскольку оно обеспечивает положительность, что является вполне разумным предположением (например, маркетинг не должен иметь негативного эффекта).</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>sigma <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(mu <span style="color:#f92672">-</span> <span style="color:#ae81ff">4</span><span style="color:#f92672">*</span>sigma, mu <span style="color:#f92672">+</span> <span style="color:#ae81ff">4</span><span style="color:#f92672">*</span>sigma, <span style="color:#ae81ff">100</span>)
</span></span><span style="display:flex;"><span>y <span style="color:#f92672">=</span> halfnorm<span style="color:#f92672">.</span>pdf(x, scale<span style="color:#f92672">=</span>sigma)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(x, y, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;blue&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>fill_between(x, y, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;blue&#39;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.3</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Saturation beta prior: HalfNormal Distribution (sigma=2)&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Saturation beta&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Probability Density&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>grid(<span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><h3 id="144-гамма-контроль">1.4.4 Гамма контроль</h3>
<p>Параметр гамма-контроль — это коэффициент для контрольных переменных, которые учитывают внешние факторы, такие как макроэкономические условия, праздники или другие немаркетинговые переменные.</p>
<p>Для гамма-контроля используется нормальное распределение, которое допускает как положительные, так и отрицательные эффекты:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>mu <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>sigma <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(mu <span style="color:#f92672">-</span> <span style="color:#ae81ff">4</span><span style="color:#f92672">*</span>sigma, mu <span style="color:#f92672">+</span> <span style="color:#ae81ff">4</span><span style="color:#f92672">*</span>sigma, <span style="color:#ae81ff">100</span>)
</span></span><span style="display:flex;"><span>y <span style="color:#f92672">=</span> norm<span style="color:#f92672">.</span>pdf(x, mu, sigma)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(x, y, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;blue&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>fill_between(x, y, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;blue&#39;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.3</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Control: Normal distribution (mu=0, sigma=2)&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Control value&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Probability density&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>grid(<span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><h3 id="20-пошаговое-руководство-по-python">2.0 Пошаговое руководство по Python</h3>
<p>Теперь, когда мы рассмотрели теорию, давайте применим её на практике! В этом пошаговом руководстве мы рассмотрим:</p>
<ul>
<li>Моделирование данных.</li>
<li>Обучение модели.</li>
<li>Валидация модели.</li>
<li>Восстановление параметров.</li>
</ul>
<p>Цель — создать реалистичные тренировочные данные, где мы сами зададим параметры (адсток, насыщение, бета и т. д.), обучим и проверим модель, используя пакет <strong>pymc-marketing</strong>, а затем оценим, насколько хорошо наша модель восстановила параметры.</p>
<h3 id="21-моделирование-данных">2.1 Моделирование данных</h3>
<p>Давайте начнём с моделирования некоторых данных для обучения модели. Преимущество этого подхода заключается в том, что мы можем сами задать параметры, что позволит нам провести упражнение по восстановлению параметров для проверки работы нашей модели.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> pymc_marketing.mmm.transformers <span style="color:#f92672">import</span> geometric_adstock, logistic_saturation
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.preprocessing <span style="color:#f92672">import</span> MaxAbsScaler
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">data_generator</span>(start_date, periods, channels, spend_scalar, adstock_alphas, saturation_lamdas, betas, freq<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;W&#34;</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;&#39;&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Generates a synthetic dataset for a MMM with trend, seasonality, and channel-specific contributions.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#39;&#39;&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># [код для генерации данных]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> df
</span></span></code></pre></div><h3 id="22-обучение-модели">2.2 Обучение модели</h3>
<p>Теперь пришло время обучить модель. Для начала нам нужно подготовить обучающие данные:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>date_col <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;date&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>y_col <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;sales&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>channel_cols <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;tv_spend_raw&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;social_spend_raw&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;search_spend_raw&#34;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>control_cols <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;demand_proxy&#34;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>X <span style="color:#f92672">=</span> df[[date_col] <span style="color:#f92672">+</span> channel_cols <span style="color:#f92672">+</span> control_cols]
</span></span><span style="display:flex;"><span>y <span style="color:#f92672">=</span> df[y_col]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>test_len <span style="color:#f92672">=</span> <span style="color:#ae81ff">8</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>train_idx <span style="color:#f92672">=</span> slice(<span style="color:#ae81ff">0</span>, len(df) <span style="color:#f92672">-</span> test_len)
</span></span><span style="display:flex;"><span>out_of_time_idx <span style="color:#f92672">=</span> slice(len(df) <span style="color:#f92672">-</span> test_len, len(df))
</span></span></code></pre></div><h3 id="23-валидация-модели">2.3 Валидация модели</h3>
<p>После обучения модели первый шаг — проверить наличие дивергенций. Дивергенции указывают на потенциальные проблемы либо с моделью, либо с процессом выборки.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>mmm_default<span style="color:#f92672">.</span>idata[<span style="color:#e6db74">&#34;sample_stats&#34;</span>][<span style="color:#e6db74">&#34;diverging&#34;</span>]<span style="color:#f92672">.</span>sum()<span style="color:#f92672">.</span>item()
</span></span></code></pre></div><h3 id="24-восстановление-параметров">2.4 Восстановление параметров</h3>
<p>В последнем разделе мы проверили модель и пришли к выводу, что она надёжна. Однако упражнение по восстановлению параметров показало, что наша модель значительно переоценивает эффект маркетинга. Эта переоценка обусловлена смешивающим фактором спроса.</p>
<h4 id="241-восстановление-параметров--адсток">2.4.1 Восстановление параметров — Адсток</h4>
<p>Давайте начнём со сравнения апостериорного распределения параметров адстока с истинными значениями, которые мы ранее сохранили в списке adstock_alphas. Модель показала себя достаточно хорошо, достигнув правильного порядка ранжирования, и истинные значения последовательно лежат в пределах апостериорного распределения.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>fig <span style="color:#f92672">=</span> mmm_default<span style="color:#f92672">.</span>plot_channel_parameter(param_name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;adstock_alpha&#34;</span>, figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>ax <span style="color:#f92672">=</span> fig<span style="color:#f92672">.</span>axes[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>axvline(x<span style="color:#f92672">=</span>adstock_alphas[<span style="color:#ae81ff">0</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;C0&#34;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;--&#34;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;$alpha_1$&#34;</span>)
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>axvline(x<span style="color:#f92672">=</span>adstock_alphas[<span style="color:#ae81ff">1</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;C1&#34;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;--&#34;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;$alpha_2$&#34;</span>)
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>axvline(x<span style="color:#f92672">=</span>adstock_alphas[<span style="color:#ae81ff">2</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;C2&#34;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;--&#34;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;$alpha_3$&#34;</span>)
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>legend(loc<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;upper right&#34;</span>);
</span></span></code></pre></div><h4 id="242-восстановление-параметров--сатурация">2.4.2 Восстановление параметров — Сатурация</h4>
<p>При рассмотрении насыщения модель отлично справляется с восстановлением лямбда для ТВ, но не так хорошо справляется с восстановлением истинных значений для социальных сетей и поиска, хотя результаты не являются катастрофическими.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>fig <span style="color:#f92672">=</span> mmm_default<span style="color:#f92672">.</span>plot_channel_parameter(param_name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;saturation_lam&#34;</span>, figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>ax <span style="color:#f92672">=</span> fig<span style="color:#f92672">.</span>axes[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>axvline(x<span style="color:#f92672">=</span>saturation_lamdas[<span style="color:#ae81ff">0</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;C0&#34;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;--&#34;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;$lambda_1$&#34;</span>)
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>axvline(x<span style="color:#f92672">=</span>saturation_lamdas[<span style="color:#ae81ff">1</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;C1&#34;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;--&#34;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;$lambda_2$&#34;</span>)
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>axvline(x<span style="color:#f92672">=</span>saturation_lamdas[<span style="color:#ae81ff">2</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;C2&#34;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;--&#34;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;$lambda_3$&#34;</span>)
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>legend(loc<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;upper right&#34;</span>);
</span></span></code></pre></div><h4 id="243-восстановление-параметров--канальные-беты">2.4.3 Восстановление параметров — Канальные беты</h4>
<p>Что касается канальных бета-параметров, модель достигает правильного порядка ранжирования, но переоценивает значения для всех каналов.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>fig <span style="color:#f92672">=</span> mmm_default<span style="color:#f92672">.</span>plot_channel_parameter(param_name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;saturation_beta&#34;</span>, figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>ax <span style="color:#f92672">=</span> fig<span style="color:#f92672">.</span>axes[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>axvline(x<span style="color:#f92672">=</span>betas_scaled[<span style="color:#ae81ff">0</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;C0&#34;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;--&#34;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;$beta_1$&#34;</span>)
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>axvline(x<span style="color:#f92672">=</span>betas_scaled[<span style="color:#ae81ff">1</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;C1&#34;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;--&#34;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;$beta_2$&#34;</span>)
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>axvline(x<span style="color:#f92672">=</span>betas_scaled[<span style="color:#ae81ff">2</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;C2&#34;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;--&#34;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;$beta_3$&#34;</span>)
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>legend(loc<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;upper right&#34;</span>);
</span></span></code></pre></div><h4 id="244-восстановление-параметров--канальный-вклад">2.4.4 Восстановление параметров — Канальный вклад</h4>
<p>Сначала мы вычисляем истинные вклады для каждого канала. Мы также вычислим вклад спроса: помните, что мы включили прокси для спроса, а не сам спрос.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>channels <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([<span style="color:#e6db74">&#34;tv&#34;</span>, <span style="color:#e6db74">&#34;social&#34;</span>, <span style="color:#e6db74">&#34;search&#34;</span>, <span style="color:#e6db74">&#34;demand&#34;</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>true_contributions <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;Channels&#39;</span>: channels, <span style="color:#e6db74">&#39;Contributions&#39;</span>: contributions})
</span></span><span style="display:flex;"><span>true_contributions<span style="color:#f92672">=</span> true_contributions<span style="color:#f92672">.</span>sort_values(by<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Contributions&#39;</span>, ascending<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)<span style="color:#f92672">.</span>reset_index(drop<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>true_contributions <span style="color:#f92672">=</span> true_contributions<span style="color:#f92672">.</span>style<span style="color:#f92672">.</span>bar(subset<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;Contributions&#39;</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;lightblue&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>true_contributions
</span></span></code></pre></div><p>Теперь давайте построим вклады от модели. Ранжирование для спроса, ТВ, социальных сетей и поиска правильное. Однако ТВ, социальные сети и поиск значительно переоценены. Это, по-видимому, обусловлено тем, что прокси для спроса вносит не такой большой вклад, как истинный спрос.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>mmm_default<span style="color:#f92672">.</span>plot_waterfall_components_decomposition(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">6</span>));
</span></span></code></pre></div><h2 id="заключительные-мысли">Заключительные мысли</h2>
<p>В разделе 2.3 мы проверили модель и пришли к выводу, что она надёжна. Однако упражнение по восстановлению параметров показало, что наша модель значительно переоценивает эффект маркетинга. Эта переоценка обусловлена смешивающим фактором спроса. В реальных сценариях невозможно провести упражнение по восстановлению параметров. Так как же вы определите, что вклады маркетинга в вашей модели смещены? И как только вы это определите, как вы устраните эту проблему? Это подводит нас к следующей статье о калибровке моделей!</p>
<hr>
<p>Надеюсь, вам понравилась эта первая часть! Подписывайтесь на меня, если хотите продолжить этот путь к освоению МММ — в следующей статье мы сместим фокус на калибровку наших моделей, используя информативные априорные значения из экспериментов.</p>

    </div>

    <div class="tags mt-8">
      

    </div>
  </article>

          
            
  </main>          

    <script>

        
        
        const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
        const sidebar = document.querySelector('.sidebar');
        
        mobileMenuBtn.addEventListener('click', () => {
            sidebar.classList.toggle('open');
        });
        
        
        const observerOptions = {
            root: null,
            rootMargin: '0px',
            threshold: 0.5
        };
        
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                const id = entry.target.getAttribute('id');
                if (entry.isIntersecting) {
                    document.querySelectorAll(`.toc-link[href="#${id}"]`).forEach(link => {
                        link.classList.add('active');
                    });
                } else {
                    document.querySelectorAll(`.toc-link[href="#${id}"]`).forEach(link => {
                        link.classList.remove('active');
                    });
                }
            });
        }, observerOptions);
        
        
        document.querySelectorAll('h2[id]').forEach(heading => {
            observer.observe(heading);
        });
    </script>


  <footer class="px-6 py-12 bg-sky-950 text-white/50">
    
<p>P9X.ru 2010 - 2025г. услуги интернет маркетинга</p>

<script type="text/javascript">
    (function(m,e,t,r,i,k,a){
        m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();
        for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
        k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
    })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=105149615', 'ym');

    ym(105149615, 'init', {ssr:true, webvisor:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true});
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/105149615" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

  </footer>
</body>
</html>
