<!DOCTYPE html>
<html lang="ru" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>Удобное байесовское моделирование маркетингового комплекса с помощью PyMC Marketing | На пути к науке о данных | Агентство контекстной рекламы</title>
<meta name="description" content="">
<meta name="yandex-verification" content="242f5a0ee52d5836" />

<link rel="icon" type="image/x-icon" href="http://localhost:1313/favicon.ico">

    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
 <style>
  .content h1 { 
        font-size: 1.875rem; 
        font-weight: bold; 
        margin-bottom: 1rem; 
    }
    .content h2 { 
        font-size: 1.5rem; 
        font-weight: 600; 
        margin-bottom: 0.75rem; 
    }
    .content h3 { 
        font-size: 1.25rem; 
        font-weight: 500; 
        margin-bottom: 0.5rem; 
    }
    .content p { 
        margin-bottom: 1rem; 
    }
    .content ul { 
        list-style-type: disc; 
        list-style-position: inside; 
        margin-bottom: 1rem; 
    }
    .content ol { 
        list-style-type: decimal; 
        list-style-position: inside; 
        margin-bottom: 1rem; 
    }
    .content a { 
        color: #2563eb; 
    }
    .content a:hover { 
        color: #1e40af; 
    }
    .content blockquote { 
        border-left: 4px solid #d1d5db; 
        padding-left: 1rem; 
        font-style: italic; 
    }

    
.content table {
    width: 100%;
    border-collapse: collapse;
    margin: 1.5rem 0;
    font-size: 0.875rem;
    box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
    border-radius: 0.5rem;
    overflow: hidden;
    border: 1px solid #e5e7eb;
}

.dark-mode .content table {
    border: 1px solid #4b5563;
}

.content thead {
    background-color: #eaebec;
}

.dark-mode .content thead {
    background-color: #374151;
}

.content th {
    padding: 0.75rem 1rem;
    text-align: left;
    font-weight: 600;
    color: #374151;
    border-bottom: 1px solid #e5e7eb;
    border-right: 1px solid #e5e7eb;  
    font-size: 0.875rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

.dark-mode .content th {
    color: #f9fafb;
    border-bottom: 1px solid #4b5563;
    border-right: 1px solid #4b5563;  
}

.content th:last-child {
    border-right: none;  
}

.content td {
    padding: 0.75rem 1rem;
    border-bottom: 1px solid #e5e7eb;
    border-right: 1px solid #e5e7eb;  
    color: #6b7280;
}

.dark-mode .content td {
    color: #d1d5db;
    border-bottom: 1px solid #4b5563;
    border-right: 1px solid #4b5563;  
}

.content td:last-child {
    border-right: none;  
}

.content tbody tr {
    transition: background-color 0.15s ease-in-out;
}

.content tbody tr:hover {
    background-color: #f9fafb;
}

.dark-mode .content tbody tr:hover {
    background-color: #374151;
}

.content tbody tr:last-child td {
    border-bottom: none;
}

 
.content tbody tr:nth-child(even) {
    background-color: #f4f5f7;
}

.dark-mode .content tbody tr:nth-child(even) {
    background-color: #1f2937;
}

.dark-mode .content tbody tr:nth-child(even):hover {
    background-color: #374151;
}

 
.content code:not(pre code) {
    background-color: #f3f4f6;
    color: #dc2626;
    padding: 0.125rem 0.375rem;
    border-radius: 0.25rem;
    font-size: 0.875em;
    font-weight: 500;
    border: 1px solid #e5e7eb;
    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', 'source-code-pro', monospace;
}

.dark-mode .content code:not(pre code) {
    background-color: #224464;
    color: #f87171;
    border: 1px solid #4b5563;
}

 
.content pre {
    background-color: #224464;
    color: #f9fafb;
    padding: 1rem;
    border-radius: 0.5rem;
    overflow-x: auto;
    margin: 1.5rem 0;
    border: 1px solid #374151;
    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', 'source-code-pro', monospace;
    font-size: 0.875rem;
    line-height: 1.5;
}

.dark-mode .content pre {
    background-color: #111827;
    border: 1px solid #374151;
}

 
.content pre code {
    background: none;
    color: inherit;
    padding: 0;
    border: none;
    font-size: inherit;
    font-weight: normal;
}

 
.content pre code .keyword { color: #f472b6; }  
.content pre code .function { color: #60a5fa; }  
.content pre code .string { color: #34d399; }  
.content pre code .comment { color: #9ca3af; font-style: italic; }  
.content pre code .number { color: #fbbf24; }  
.content pre code .class { color: #c084fc; }  
.content pre code .operator { color: #93c5fd; }  

 
.content pre::-webkit-scrollbar {
    height: 6px;
}

.content pre::-webkit-scrollbar-track {
    background: #374151;
    border-radius: 0 0 0.5rem 0.5rem;
}

.content pre::-webkit-scrollbar-thumb {
    background: #6b7280;
    border-radius: 3px;
}

.content pre::-webkit-scrollbar-thumb:hover {
    background: #9ca3af;
}

 
.content h1 code:not(pre code),
.content h2 code:not(pre code),
.content h3 code:not(pre code) {
    font-size: 0.9em;
    background-color: #fef2f2;
    color: #dc2626;
}

.dark-mode .content h1 code:not(pre code),
.dark-mode .content h2 code:not(pre code),
.dark-mode .content h3 code:not(pre code) {
    background-color: #7f1d1d;
    color: #fca5a5;
}

 
.content a code:not(pre code) {
    color: inherit;
    background-color: rgba(59, 130, 246, 0.1);
}

.dark-mode .content a code:not(pre code) {
    background-color: rgba(96, 165, 250, 0.2);
}
        :root {
            --color-bg: #1a1a1a;
            --color-text: #e6e6e6;
            --color-accent: #6b7280;
            --color-link: #9ca3af;
            --color-link-hover: #d1d5db;
        }
        
        .light-mode {
            --color-bg: #f9fafb;
            --color-text: #1f2937;
            --color-accent: #6b7280;
            --color-link: #4b5563;
            --color-link-hover: #111827;
        }
        
        body {
            background-color: var(--color-bg);
            color: var(--color-text);
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
            transition: background-color 0.3s, color 0.3s;
        }
        
        a {
            color: var(--color-link);
            text-decoration: none;
            transition: color 0.2s;
        }
        
        a:hover {
            color: var(--color-link-hover);
        }
        
        .sidebar {
            position: fixed;
             
            height: 100vh;
            overflow-y: auto;
            
        }
        
        .main-content {
            margin-left: 350px;
            
             
        }
        
        .toc-container {
            position: fixed;
            right: 2rem;
            top: 2rem;
            width: 250px;
            display: none;
        }
        
        @media (min-width: 1280px) {
            .toc-container {
                display: block;
            }
        }
        
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease;
                z-index: 50;
            }
            
            .sidebar.open {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 0;
                 
            }
            
            .mobile-menu-btn {
                display: block;
                position: fixed;
                top: 1rem;
                left: 1rem;
                z-index: 100;
            }
        }
        
        .toc-link.active {
            color: var(--color-link-hover);
            font-weight: bold;
        }
        
        .social-icons a {
            margin-right: 0.5rem;
        }
        
        pre {
            background-color: rgba(107, 114, 128, 0.1);
            padding: 1rem;
            border-radius: 0.25rem;
            overflow-x: auto;
        }
        
        code {
            font-family: Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
        }
    </style>
</head>
  <body class="light-mode">
      <header>
    
  </header>
    
    <button class="mobile-menu-btn p-2 bg-gray-800 text-white rounded md:hidden">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
    </button>

    
    <aside class="sidebar border-r-4 border-sky-800  min-w-[350px] py-12 px-10 bg-gradient-to-br from-cyan-200 via-green-100 to-sky-100">
        <div class="flex flex-col items-center mb-8">
                
            
            <div class="w-24 h-24 mb-4 relative">
                <a href="/">
                <svg version="1.0" xmlns="http://www.w3.org/2000/svg"
 viewBox="0 0 550.000000 385.000000"
 preserveAspectRatio="xMidYMid meet">

<g transform="translate(0.000000,385.000000) scale(0.100000,-0.100000)"
fill="#000000" stroke="none">
<path d="M2780 3000 l0 -300 40 0 40 0 0 260 0 260 1165 0 1165 0 0 -1245 0
-1245 -1165 0 -1165 0 0 260 0 260 -40 0 -40 0 0 -300 0 -300 1245 0 1245 0 0
1325 0 1325 -1245 0 -1245 0 0 -300z"/>
<path d="M700 1975 l0 -635 145 0 145 0 0 245 0 245 383 0 c422 0 426 1 491
66 60 60 66 88 66 319 0 190 -2 214 -21 255 -25 56 -53 86 -104 113 -39 22
-49 22 -572 25 l-533 3 0 -636z m940 245 l0 -100 -325 0 -325 0 0 100 0 100
325 0 325 0 0 -100z"/>
<path d="M2320 2601 c-69 -22 -112 -58 -146 -121 -17 -31 -19 -60 -19 -260 0
-211 1 -227 22 -265 27 -51 68 -90 115 -109 32 -14 98 -16 438 -16 l400 0 0
-245 0 -245 145 0 145 0 0 536 c0 373 -3 548 -11 575 -16 50 -61 105 -112 132
-41 22 -48 22 -497 24 -250 1 -466 -2 -480 -6z m810 -381 l0 -100 -340 0 -340
0 0 100 0 100 340 0 340 0 0 -100z"/>
<path d="M3650 2607 c0 -1 99 -144 219 -317 l219 -314 -63 -91 c-34 -49 -133
-191 -219 -315 l-157 -225 172 -3 c97 -1 176 2 183 7 6 5 72 97 146 205 74
107 138 196 141 196 4 0 71 -92 149 -205 l143 -205 173 0 c96 0 174 2 174 4 0
3 -95 141 -211 308 -116 167 -214 308 -216 315 -3 7 92 151 211 322 119 170
216 312 216 315 0 3 -78 6 -174 6 l-174 0 -143 -205 c-78 -113 -145 -205 -149
-205 -3 0 -70 92 -148 205 l-143 205 -174 0 c-96 0 -175 -1 -175 -3z"/>
</g>
</svg>
</a>
            </div>

            <p class="text-xs text-center text-gray-500 max-w-[200px]">
                Профессиональное агентство контекстной рекламы с опытом более 18 лет.

            </p>
        </div>

        
        <nav class="mb-8">
          
        
            
  <nav>
    <ul>
    <li class="text-lg font-semibold">
      <a href="/">Контекстная реклама</a>
    </li>
    <li class="text-lg font-semibold">
      <a href="/analytics/">web-аналитика</a>
    </li>
    <li class="text-lg font-semibold">
      <a aria-current="true" class="ancestor" href="/posts/">Блог</a>
    </li>
    <li class="text-lg font-semibold">
      <a href="/about/">О нас</a>
    </li>
    <li class="text-lg font-semibold">
      <a href="/tags/">Категории</a>
    </li>
    <li class="text-lg font-semibold">
      <a href="/job/">Вакансии</a>
    </li>
    <li class="text-lg font-semibold">
      <a href="/tags/">Кейсы</a>
    </li>
    <li class="text-lg font-semibold">
      <a href="/calculators/">Калькуляторы</a>
    </li>
    <li class="text-lg font-semibold">
      <a href="/contacts/">Контакты</a>
    </li>
    </ul>
  </nav>

           

        </nav>

        
        <div class="social-icons  mt-auto">
<div>

<a href="https://t.me/your_link" target="_blank" class="inline-flex 
items-center justify-center px-3 py-3 text-white bg-[#2AABEE] font-medium text-sm rounded 
shadow-md hover:bg-[#279fd9] 
hover:shadow-lg focus:bg-[#2493c8] 
focus:shadow-lg focus:outline-none 
focus:ring-0 active:bg-[#2185b3] active:shadow-lg transition duration-150 ease-in-out">
  
     
<svg width="25px" height="25px" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" 
fill="#fff" class="bi bi-telegram pr-1">
  <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8.287 5.906c-.778.324-2.334.994-4.666 2.01-.378.15-.577.298-.595.442-.03.243.275.339.69.47l.175.055c.408.133.958.288 1.243.294.26.006.549-.1.868-.32 2.179-1.471 3.304-2.214 3.374-2.23.05-.012.12-.026.166.016.047.041.042.12.037.141-.03.129-1.227 1.241-1.846 1.817-.193.18-.33.307-.358.336a8.154 8.154 0 0 1-.188.186c-.38.366-.664.64.015 1.088.327.216.589.393.85.571.284.194.568.387.936.629.093.06.183.125.27.187.331.236.63.448.997.414.214-.02.435-.22.547-.82.265-1.417.786-4.486.906-5.751a1.426 1.426 0 0 0-.013-.315.337.337 0 0 0-.114-.217.526.526 0 0 0-.31-.093c-.3.005-.763.166-2.984 1.09z"/>
</svg>
                            
  
  Открыть в Telegram
</a>

</div>
            <div class="pt-6 flex gap-1 justify-left items-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                </svg>
                sale@p9x.ru
            </div>
        </div>
        
        
        <div class="mt-8 pt-4 text-xs text-gray-500 border-t border-gray-700">
            <p>Powered by <a href="#" class="hover:underline">Hugo</a> | Themed with <a href="#" class="hover:underline">poison</a></p>
            <p>© 2010 - 2025 Poison. All rights reserved.</p>
        </div>
    </aside>

  <main class="main-content bg-white">
 
            
            
  <article class="prose prose-lg py-8 px-4 max-w-[1200px]">
    <h1 class="text-2xl font-bold mb-4">
            Удобное Байесовское моделирование комплекса маркетинга с помощью PyMC Marketing
    </h1>

    
    
    <time class="block mb-6 text-gray-500" datetime="2025-11-19T22:53:35&#43;00:00">November 19, 2025</time>

    <div class="content mb-8 ">
      <h3 id="фотография-натана-фертига-на-unsplash">Фотография Натана Фертига на Unsplash</h3>
<p>Вы можете определить важность темы по тому, сколько крупных компаний выпускают по ней пакеты программного обеспечения. В области моделирования маркетингового микса даже лучше, чем моделирование маркетингового микса, является <strong>байесовское моделирование маркетингового микса</strong>, которое предоставляют библиотеки Google и PyMC Labs. Хотя LMMM, безусловно, тоже интересна, сегодня мы сосредоточимся на PyMC Marketing.</p>
<p>В этой статье вы узнаете, насколько легко построить современную байесовскую модель маркетингового микса!</p>
<hr>
<p>Если вам нужно освежить знания, ознакомьтесь с моей старой статьёй, в которой рассказывается о том, что такое байесовское моделирование маркетингового микса.</p>
<blockquote>
<p><strong>Байесовское моделирование маркетингового микса в Python через PyMC3</strong></p>
</blockquote>
<h2 id="ручной-процесс">Ручной процесс</h2>
<p>В моей старой статье (см. выше) я сам написал байесовскую модель маркетингового микса. Для этого мне нужно было определить функцию для эффекта переноса расходов на медиа, что было громоздко. Всё ещё используя более старую версию PyMC3, это выглядело так:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> theano.tensor <span style="color:#66d9ef">as</span> tt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">carryover</span>(x, strength, length):
</span></span><span style="display:flex;"><span>    w <span style="color:#f92672">=</span> tt<span style="color:#f92672">.</span>as_tensor_variable(
</span></span><span style="display:flex;"><span>        [tt<span style="color:#f92672">.</span>power(strength, i) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(length)]
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    x_lags <span style="color:#f92672">=</span> tt<span style="color:#f92672">.</span>stack(
</span></span><span style="display:flex;"><span>        [tt<span style="color:#f92672">.</span>concatenate([
</span></span><span style="display:flex;"><span>            tt<span style="color:#f92672">.</span>zeros(i),
</span></span><span style="display:flex;"><span>            x[:x<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">-</span>i]
</span></span><span style="display:flex;"><span>        ]) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(length)]
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> tt<span style="color:#f92672">.</span>dot(w, x_lags)
</span></span></code></pre></div><p>Это работает, но его непросто разобрать, и он может быть менее эффективным. Кроме того, использование Theano в PyMC устарело, поскольку теперь мне пришлось бы использовать PyTensor, форк Aesara, основанный на Theano. Похоже, это сложная история.</p>
<p>Поэтому я сейчас полагаюсь на более профессиональный и общий код для достижения своих целей. Я многому научился, проверив, как они реализовали эффект переноса.</p>
<p>Прежде чем продолжить, убедитесь, что у вас установлены пакеты pymc и pymc-marketing. Я установил PyMC с помощью mamba, как описано на их GitHub, а затем установил pymc-marketing через</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pip install pymc<span style="color:#f92672">-</span>marketing
</span></span></code></pre></div><h2 id="pymc-marketing">PyMC Marketing</h2>
<p>Давайте ещё раз рассмотрим наш старый пример из моей статьи о байесовском моделировании маркетингового микса. Начнём с импорта набора данных, который я создал синтетически.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>data <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;https://raw.githubusercontent.com/Garve/datasets/4576d323bf2b66c906d5130d686245ad205505cf/mmm.csv&#39;</span>,
</span></span><span style="display:flex;"><span>    parse_dates<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;Date&#39;</span>]
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></div><p>Данные выглядят так:</p>
<h3 id="определение-модели">Определение модели</h3>
<p>Теперь давайте представим нашу звезду и определим модель:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pymc_marketing.mmm <span style="color:#f92672">import</span> DelayedSaturatedMMM
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>mmm <span style="color:#f92672">=</span> DelayedSaturatedMMM(
</span></span><span style="display:flex;"><span>    data<span style="color:#f92672">=</span>data,
</span></span><span style="display:flex;"><span>    target_column<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Sales&#34;</span>,
</span></span><span style="display:flex;"><span>    date_column<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Date&#34;</span>,
</span></span><span style="display:flex;"><span>    channel_columns<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#34;TV&#34;</span>, <span style="color:#e6db74">&#34;Radio&#34;</span>, <span style="color:#e6db74">&#34;Banners&#34;</span>]
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></div><p>Это создаёт модель с насыщением и эффектом переноса по каналам, аналогично тому, что я делал вручную раньше. Поэтому я не буду вдаваться в подробности о том, как эта модель работает с математической точки зрения.</p>
<hr>
<p>Мы можем визуализировать то, что создали:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pymc <span style="color:#66d9ef">as</span> pm
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pm<span style="color:#f92672">.</span>model_to_graphviz(model<span style="color:#f92672">=</span>mmm<span style="color:#f92672">.</span>model)
</span></span></code></pre></div><p>Здесь мы видим, что сначала применяется адсток (перенос), затем насыщение. У нас есть три параметра <code>alpha</code>, <code>beta_channel</code> и <code>lam</code> на канал, где:</p>
<ul>
<li><code>alpha</code> — это скорость переноса, которая находится между 0 и 1,</li>
<li><code>lam</code> — это скорость насыщения,</li>
<li><code>beta_channel</code> — это фактический коэффициент линейной регрессии.</li>
</ul>
<p>Чтобы дать немного больше контекста, формула сокращённой модели:</p>
<p>где <em>c</em> пробегает по всем различным каналам.</p>
<h3 id="подгонка-модели">Подгонка модели</h3>
<p>Подгонка модели так же проста, как в scikit-learn:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>mmm<span style="color:#f92672">.</span>fit()
</span></span></code></pre></div><h3 id="вывод-модели">Вывод модели</h3>
<p>После обучения модели мы можем проверить параметры следующим образом:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> arviz <span style="color:#66d9ef">as</span> az
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>az<span style="color:#f92672">.</span>summary(
</span></span><span style="display:flex;"><span>    data<span style="color:#f92672">=</span>mmm<span style="color:#f92672">.</span>fit_result,
</span></span><span style="display:flex;"><span>    var_names<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#34;intercept&#34;</span>, <span style="color:#e6db74">&#34;beta_channel&#34;</span>, <span style="color:#e6db74">&#34;alpha&#34;</span>, <span style="color:#e6db74">&#34;lam&#34;</span>, <span style="color:#e6db74">&#34;sigma&#34;</span>]
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></div><p>Я получил что-то вроде этого:</p>
<p>Судя по 1.0 в столбце <strong>r_hat</strong>, мы видим, что цепи, похоже, сошлась просто отлично, то есть результаты в остальной части таблицы надёжны.</p>
<p>Мы также можем проверить, какие значения модель считает правильными для всех параметров. Например, канал TV carryover <code>alpha[TV]</code> находится между 0,465 и 0,515 с вероятностью 94%, как видно в столбцах <strong>hdi_3% и hdi_97%</strong>. Если бы модель должна была выбрать одно число, это было бы 0,49, как вы можете видеть в столбце <strong>mean</strong>.</p>
<blockquote>
<p><strong>Примечание:</strong> для создания этого набора данных я использовал значения насыщения 0,5 для ТВ, 0,2 для радио и 0 для баннеров. Наша модель PyMC смогла подобрать их довольно прилично!</p>
</blockquote>
<p>Для визуалов:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>mmm<span style="color:#f92672">.</span>plot_channel_parameter(param_name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;alpha&#34;</span>, figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">5</span>))
</span></span></code></pre></div><p>Мы даже можем проверить вклад каналов, используя удобный метод</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>mmm<span style="color:#f92672">.</span>plot_channel_contribution_share_hdi()
</span></span></code></pre></div><p>Согласно модели, ТВ несёт ответственность примерно за 40% <strong>дополнительных</strong> продаж (дополнительно к базе), радио — примерно за 26%, а баннеры — примерно за 34%.</p>
<h3 id="проверка-апостериорных-предсказаний">Проверка апостериорных предсказаний</h3>
<p>Мы можем провести проверку апостериорных предсказаний, то есть выборку прогнозов (синий), и посмотреть, насколько хорошо они соответствуют модели (чёрный).</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>mmm<span style="color:#f92672">.</span>plot_posterior_predictive(original_scale<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span></code></pre></div><p>Похоже на хорошую подгонку! Мы даже можем разложить сигнал на базовый уровень и вклад каналов через</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>mmm<span style="color:#f92672">.</span>plot_components_contributions()
</span></span></code></pre></div><h3 id="заключение">Заключение</h3>
<p>Байесовское моделирование маркетингового микса в настоящее время является <strong>лучшим</strong> способом узнать, какие из ваших маркетинговых каналов работают хорошо, а какие — нет. Создание такой модели не слишком сложно, но всё же далеко не так просто, как собрать модель scikit-learn.</p>
<p>К счастью, новый PyMC Marketing упрощает байесовское моделирование маркетингового микса по сравнению с тем, что нам приходилось кодировать вручную.</p>
<p>Не поймите меня неправильно, мне нравится программировать, и очень важно, чтобы <strong>вы</strong> тоже умели это делать. Но всё же приятно иметь хорошо поддерживаемый пакет, который, вероятно, будет получать ещё больше функций для маркетинговых миксов в будущем.</p>
<p>И я охватил лишь <strong>некоторые</strong> из функций. PyMC Marketing может даже:</p>
<ul>
<li>эффективно работать с контрольными переменными, передавая список столбцов через <code>control_columns</code> в класс <code>DelayedSaturatedMMM</code>;</li>
<li>строить графики кривых насыщения через <code>mmm.plot_contribution_curves()</code>;</li>
<li>рассчитывать ROAS, хотя это всё ещё ручная работа.</li>
</ul>
<p>Для получения дополнительной информации ознакомьтесь с этим замечательным ноутбуком от людей из PyMC.</p>
<hr>
<p>Надеюсь, вы узнали что-то новое, интересное и ценное сегодня. Спасибо за чтение!</p>
<blockquote>
<p>Если у вас есть вопросы, напишите мне в LinkedIn!</p>
</blockquote>
<p>И если вы хотите глубже погрузиться в мир алгоритмов, попробуйте мою новую публикацию <strong>Всё об алгоритмах</strong>! Я всё ещё ищу авторов!</p>

    </div>

    <div class="tags mt-8">
      

    </div>
  </article>

          
            
  </main>          

    <script>

        
        
        const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
        const sidebar = document.querySelector('.sidebar');
        
        mobileMenuBtn.addEventListener('click', () => {
            sidebar.classList.toggle('open');
        });
        
        
        const observerOptions = {
            root: null,
            rootMargin: '0px',
            threshold: 0.5
        };
        
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                const id = entry.target.getAttribute('id');
                if (entry.isIntersecting) {
                    document.querySelectorAll(`.toc-link[href="#${id}"]`).forEach(link => {
                        link.classList.add('active');
                    });
                } else {
                    document.querySelectorAll(`.toc-link[href="#${id}"]`).forEach(link => {
                        link.classList.remove('active');
                    });
                }
            });
        }, observerOptions);
        
        
        document.querySelectorAll('h2[id]').forEach(heading => {
            observer.observe(heading);
        });
    </script>


  <footer class="px-6 py-12 bg-sky-950 text-white/50">
    
<p>P9X.ru 2010 - 2025г. услуги интернет маркетинга</p>

<script type="text/javascript">
    (function(m,e,t,r,i,k,a){
        m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();
        for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
        k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
    })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=105149615', 'ym');

    ym(105149615, 'init', {ssr:true, webvisor:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true});
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/105149615" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

  </footer>
</body>
</html>
