<!DOCTYPE html>
<html lang="ru" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>Байесовское моделирование маркетингового комплекса на Python с помощью PyMC | На пути к науке о данных | Агентство контекстной рекламы</title>
<meta name="description" content="">
<meta name="yandex-verification" content="242f5a0ee52d5836" />

<link rel="icon" type="image/x-icon" href="http://localhost:1313/favicon.ico">

    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
 <style>
  .content h1 { 
        font-size: 1.875rem; 
        font-weight: bold; 
        margin-bottom: 1rem; 
    }
    .content h2 { 
        font-size: 1.5rem; 
        font-weight: 600; 
        margin-bottom: 0.75rem; 
    }
    .content h3 { 
        font-size: 1.25rem; 
        font-weight: 500; 
        margin-bottom: 0.5rem; 
    }
    .content p { 
        margin-bottom: 1rem; 
    }
    .content ul { 
        list-style-type: disc; 
        list-style-position: inside; 
        margin-bottom: 1rem; 
    }
    .content ol { 
        list-style-type: decimal; 
        list-style-position: inside; 
        margin-bottom: 1rem; 
    }
    .content a { 
        color: #2563eb; 
    }
    .content a:hover { 
        color: #1e40af; 
    }
    .content blockquote { 
        border-left: 4px solid #d1d5db; 
        padding-left: 1rem; 
        font-style: italic; 
    }

    
.content table {
    width: 100%;
    border-collapse: collapse;
    margin: 1.5rem 0;
    font-size: 0.875rem;
    box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
    border-radius: 0.5rem;
    overflow: hidden;
    border: 1px solid #e5e7eb;
}

.dark-mode .content table {
    border: 1px solid #4b5563;
}

.content thead {
    background-color: #eaebec;
}

.dark-mode .content thead {
    background-color: #374151;
}

.content th {
    padding: 0.75rem 1rem;
    text-align: left;
    font-weight: 600;
    color: #374151;
    border-bottom: 1px solid #e5e7eb;
    border-right: 1px solid #e5e7eb;  
    font-size: 0.875rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

.dark-mode .content th {
    color: #f9fafb;
    border-bottom: 1px solid #4b5563;
    border-right: 1px solid #4b5563;  
}

.content th:last-child {
    border-right: none;  
}

.content td {
    padding: 0.75rem 1rem;
    border-bottom: 1px solid #e5e7eb;
    border-right: 1px solid #e5e7eb;  
    color: #6b7280;
}

.dark-mode .content td {
    color: #d1d5db;
    border-bottom: 1px solid #4b5563;
    border-right: 1px solid #4b5563;  
}

.content td:last-child {
    border-right: none;  
}

.content tbody tr {
    transition: background-color 0.15s ease-in-out;
}

.content tbody tr:hover {
    background-color: #f9fafb;
}

.dark-mode .content tbody tr:hover {
    background-color: #374151;
}

.content tbody tr:last-child td {
    border-bottom: none;
}

 
.content tbody tr:nth-child(even) {
    background-color: #f4f5f7;
}

.dark-mode .content tbody tr:nth-child(even) {
    background-color: #1f2937;
}

.dark-mode .content tbody tr:nth-child(even):hover {
    background-color: #374151;
}

 
.content code:not(pre code) {
    background-color: #f3f4f6;
    color: #dc2626;
    padding: 0.125rem 0.375rem;
    border-radius: 0.25rem;
    font-size: 0.875em;
    font-weight: 500;
    border: 1px solid #e5e7eb;
    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', 'source-code-pro', monospace;
}

.dark-mode .content code:not(pre code) {
    background-color: #224464;
    color: #f87171;
    border: 1px solid #4b5563;
}

 
.content pre {
    background-color: #224464;
    color: #f9fafb;
    padding: 1rem;
    border-radius: 0.5rem;
    overflow-x: auto;
    margin: 1.5rem 0;
    border: 1px solid #374151;
    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', 'source-code-pro', monospace;
    font-size: 0.875rem;
    line-height: 1.5;
}

.dark-mode .content pre {
    background-color: #111827;
    border: 1px solid #374151;
}

 
.content pre code {
    background: none;
    color: inherit;
    padding: 0;
    border: none;
    font-size: inherit;
    font-weight: normal;
}

 
.content pre code .keyword { color: #f472b6; }  
.content pre code .function { color: #60a5fa; }  
.content pre code .string { color: #34d399; }  
.content pre code .comment { color: #9ca3af; font-style: italic; }  
.content pre code .number { color: #fbbf24; }  
.content pre code .class { color: #c084fc; }  
.content pre code .operator { color: #93c5fd; }  

 
.content pre::-webkit-scrollbar {
    height: 6px;
}

.content pre::-webkit-scrollbar-track {
    background: #374151;
    border-radius: 0 0 0.5rem 0.5rem;
}

.content pre::-webkit-scrollbar-thumb {
    background: #6b7280;
    border-radius: 3px;
}

.content pre::-webkit-scrollbar-thumb:hover {
    background: #9ca3af;
}

 
.content h1 code:not(pre code),
.content h2 code:not(pre code),
.content h3 code:not(pre code) {
    font-size: 0.9em;
    background-color: #fef2f2;
    color: #dc2626;
}

.dark-mode .content h1 code:not(pre code),
.dark-mode .content h2 code:not(pre code),
.dark-mode .content h3 code:not(pre code) {
    background-color: #7f1d1d;
    color: #fca5a5;
}

 
.content a code:not(pre code) {
    color: inherit;
    background-color: rgba(59, 130, 246, 0.1);
}

.dark-mode .content a code:not(pre code) {
    background-color: rgba(96, 165, 250, 0.2);
}
        :root {
            --color-bg: #1a1a1a;
            --color-text: #e6e6e6;
            --color-accent: #6b7280;
            --color-link: #9ca3af;
            --color-link-hover: #d1d5db;
        }
        
        .light-mode {
            --color-bg: #f9fafb;
            --color-text: #1f2937;
            --color-accent: #6b7280;
            --color-link: #4b5563;
            --color-link-hover: #111827;
        }
        
        body {
            background-color: var(--color-bg);
            color: var(--color-text);
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
            transition: background-color 0.3s, color 0.3s;
        }
        
        a {
            color: var(--color-link);
            text-decoration: none;
            transition: color 0.2s;
        }
        
        a:hover {
            color: var(--color-link-hover);
        }
        
        .sidebar {
            position: fixed;
             
            height: 100vh;
            overflow-y: auto;
            
        }
        
        .main-content {
            margin-left: 350px;
            
             
        }
        
        .toc-container {
            position: fixed;
            right: 2rem;
            top: 2rem;
            width: 250px;
            display: none;
        }
        
        @media (min-width: 1280px) {
            .toc-container {
                display: block;
            }
        }
        
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease;
                z-index: 50;
            }
            
            .sidebar.open {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 0;
                 
            }
            
            .mobile-menu-btn {
                display: block;
                position: fixed;
                top: 1rem;
                left: 1rem;
                z-index: 100;
            }
        }
        
        .toc-link.active {
            color: var(--color-link-hover);
            font-weight: bold;
        }
        
        .social-icons a {
            margin-right: 0.5rem;
        }
        
        pre {
            background-color: rgba(107, 114, 128, 0.1);
            padding: 1rem;
            border-radius: 0.25rem;
            overflow-x: auto;
        }
        
        code {
            font-family: Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
        }
    </style>
</head>
  <body class="light-mode">
      <header>
    
  </header>
    
    <button class="mobile-menu-btn p-2 bg-gray-800 text-white rounded md:hidden">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
    </button>

    
    <aside class="sidebar border-r-4 border-sky-800  min-w-[350px] py-12 px-10 bg-gradient-to-br from-cyan-200 via-green-100 to-sky-100">
        <div class="flex flex-col items-center mb-8">
                
            
            <div class="w-24 h-24 mb-4 relative">
                <a href="/">
                <svg version="1.0" xmlns="http://www.w3.org/2000/svg"
 viewBox="0 0 550.000000 385.000000"
 preserveAspectRatio="xMidYMid meet">

<g transform="translate(0.000000,385.000000) scale(0.100000,-0.100000)"
fill="#000000" stroke="none">
<path d="M2780 3000 l0 -300 40 0 40 0 0 260 0 260 1165 0 1165 0 0 -1245 0
-1245 -1165 0 -1165 0 0 260 0 260 -40 0 -40 0 0 -300 0 -300 1245 0 1245 0 0
1325 0 1325 -1245 0 -1245 0 0 -300z"/>
<path d="M700 1975 l0 -635 145 0 145 0 0 245 0 245 383 0 c422 0 426 1 491
66 60 60 66 88 66 319 0 190 -2 214 -21 255 -25 56 -53 86 -104 113 -39 22
-49 22 -572 25 l-533 3 0 -636z m940 245 l0 -100 -325 0 -325 0 0 100 0 100
325 0 325 0 0 -100z"/>
<path d="M2320 2601 c-69 -22 -112 -58 -146 -121 -17 -31 -19 -60 -19 -260 0
-211 1 -227 22 -265 27 -51 68 -90 115 -109 32 -14 98 -16 438 -16 l400 0 0
-245 0 -245 145 0 145 0 0 536 c0 373 -3 548 -11 575 -16 50 -61 105 -112 132
-41 22 -48 22 -497 24 -250 1 -466 -2 -480 -6z m810 -381 l0 -100 -340 0 -340
0 0 100 0 100 340 0 340 0 0 -100z"/>
<path d="M3650 2607 c0 -1 99 -144 219 -317 l219 -314 -63 -91 c-34 -49 -133
-191 -219 -315 l-157 -225 172 -3 c97 -1 176 2 183 7 6 5 72 97 146 205 74
107 138 196 141 196 4 0 71 -92 149 -205 l143 -205 173 0 c96 0 174 2 174 4 0
3 -95 141 -211 308 -116 167 -214 308 -216 315 -3 7 92 151 211 322 119 170
216 312 216 315 0 3 -78 6 -174 6 l-174 0 -143 -205 c-78 -113 -145 -205 -149
-205 -3 0 -70 92 -148 205 l-143 205 -174 0 c-96 0 -175 -1 -175 -3z"/>
</g>
</svg>
</a>
            </div>

            <p class="text-xs text-center text-gray-500 max-w-[200px]">
                Профессиональное агентство контекстной рекламы с опытом более 18 лет.

            </p>
        </div>

        
        <nav class="mb-8">
          
        
            
  <nav>
    <ul>
    <li class="text-lg font-semibold">
      <a href="/">Контекстная реклама</a>
    </li>
    <li class="text-lg font-semibold">
      <a href="/analytics/">web-аналитика</a>
    </li>
    <li class="text-lg font-semibold">
      <a aria-current="true" class="ancestor" href="/posts/">Блог</a>
    </li>
    <li class="text-lg font-semibold">
      <a href="/about/">О нас</a>
    </li>
    <li class="text-lg font-semibold">
      <a href="/tags/">Категории</a>
    </li>
    <li class="text-lg font-semibold">
      <a href="/job/">Вакансии</a>
    </li>
    <li class="text-lg font-semibold">
      <a href="/tags/">Кейсы</a>
    </li>
    <li class="text-lg font-semibold">
      <a href="/calculators/">Калькуляторы</a>
    </li>
    <li class="text-lg font-semibold">
      <a href="/contacts/">Контакты</a>
    </li>
    </ul>
  </nav>

           

        </nav>

        
        <div class="social-icons  mt-auto">
<div>

<a href="https://t.me/your_link" target="_blank" class="inline-flex 
items-center justify-center px-3 py-3 text-white bg-[#2AABEE] font-medium text-sm rounded 
shadow-md hover:bg-[#279fd9] 
hover:shadow-lg focus:bg-[#2493c8] 
focus:shadow-lg focus:outline-none 
focus:ring-0 active:bg-[#2185b3] active:shadow-lg transition duration-150 ease-in-out">
  
     
<svg width="25px" height="25px" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" 
fill="#fff" class="bi bi-telegram pr-1">
  <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8.287 5.906c-.778.324-2.334.994-4.666 2.01-.378.15-.577.298-.595.442-.03.243.275.339.69.47l.175.055c.408.133.958.288 1.243.294.26.006.549-.1.868-.32 2.179-1.471 3.304-2.214 3.374-2.23.05-.012.12-.026.166.016.047.041.042.12.037.141-.03.129-1.227 1.241-1.846 1.817-.193.18-.33.307-.358.336a8.154 8.154 0 0 1-.188.186c-.38.366-.664.64.015 1.088.327.216.589.393.85.571.284.194.568.387.936.629.093.06.183.125.27.187.331.236.63.448.997.414.214-.02.435-.22.547-.82.265-1.417.786-4.486.906-5.751a1.426 1.426 0 0 0-.013-.315.337.337 0 0 0-.114-.217.526.526 0 0 0-.31-.093c-.3.005-.763.166-2.984 1.09z"/>
</svg>
                            
  
  Открыть в Telegram
</a>

</div>
            <div class="pt-6 flex gap-1 justify-left items-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                </svg>
                sale@p9x.ru
            </div>
        </div>
        
        
        <div class="mt-8 pt-4 text-xs text-gray-500 border-t border-gray-700">
            <p>Powered by <a href="#" class="hover:underline">Hugo</a> | Themed with <a href="#" class="hover:underline">poison</a></p>
            <p>© 2010 - 2025 Poison. All rights reserved.</p>
        </div>
    </aside>

  <main class="main-content bg-white">
 
            
            
  <article class="prose prose-lg py-8 px-4 max-w-[1200px]">
    <h1 class="text-2xl font-bold mb-4">
            Байесовское моделирование маркетингового комплекса на Python с помощью PyMC
    </h1>

    
    
    <time class="block mb-6 text-gray-500" datetime="2025-11-19T22:09:56&#43;00:00">November 19, 2025</time>

    <div class="content mb-8 ">
      <h3 id="фото-грега-ракози-на-unsplash">Фото Грега Ракози на Unsplash</h3>
<p>В этой статье я хочу объединить две концепции, обсуждавшиеся в предыдущих постах: <strong>байесовское моделирование</strong> и <strong>моделирование маркетингового микса</strong>. Поскольку велика вероятность, что вам незнакомы обе темы, позвольте мне кратко познакомить вас с ними и предложить дополнительную литературу. Я расскажу:</p>
<ol>
<li>что такое моделирование маркетингового микса;</li>
<li>что такое байесовское моделирование;</li>
<li>почему имеет смысл объединить оба подхода.</li>
</ol>
<p>Затем я покажу вам, как это сделать на практике, используя PyMC.</p>
<h2 id="предварительные-сведения">Предварительные сведения</h2>
<p>Если вы жадно читаете мои статьи (<em>спасибо!</em>), вы можете пропустить несколько разделов, чтобы сразу перейти к коду. В противном случае продолжайте чтение.</p>
<h3 id="моделирование-маркетингового-микса">Моделирование маркетингового микса</h3>
<p>Фундаментальная проблема для каждого бизнеса — решить, на какие <em>каналы</em> тратить маркетинговый бюджет. Вы можете потратить 1 000 € на ТВ-рекламу, 2 000 € на радиорекламу и 3 000 € на веб-баннеры каждый день, полагаясь только на интуицию. Но так ли это хорошо?</p>
<p>Возможно, канал веб-баннеров уже <em>насыщен</em>, и потратить 1 500 € там так же хорошо, как 3 000 €. Тогда вы можете сэкономить 1 500 € или вложить их в другие, более эффективные каналы для увеличения продаж.</p>
<p>Или, возможно, какой-то канал имеет <em>отрицательную рентабельность инвестиций</em> — за каждый потраченный на рекламу Евро вы получаете обратно меньше одного Евро. Мы определённо не должны тратить слишком много денег на такой канал, по крайней мере, если он не является стратегически важным с точки зрения бизнеса.</p>
<p>Чтобы ответить на подобные вопросы, вы должны понимать, как различные <strong>расходы на медиа</strong> (ТВ, радио и т. д.) <strong>влияют на ваши продажи</strong> или другие ключевые показатели эффективности (KPI).</p>
<p>В моделировании маркетингового микса вы начинаете с набора данных о расходах на медиа. Обычно его дополняют некоторыми <em>контрольными переменными</em>, то есть дополнительной информацией обо всём, что может повлиять на целевой KPI, например, о праздниках, погоде, футбольных чемпионатах, локдаунах, цене продукта и многом другом. Чтобы сделать текст более кратким, мы опустим контрольные переменные здесь. Затем, конечно, вам нужен KPI, который вы хотите предсказать. Часто это продажи, количество новых клиентов и т. д. Таким образом, типичный набор данных может выглядеть следующим образом:</p>
<h3 id="байесовское-моделирование">Байесовское моделирование</h3>
<p>Многие оценки и модели основаны на подходе <em>максимального правдоподобия</em>. Например, представьте, что вы хотите оценить вероятность <em>p</em> выпадения орла при подбрасывании монеты. Вы <strong>подбрасываете её 10 раз</strong> и видите <strong>8 орлов</strong>; что вы можете заключить? Естественной оценкой для вероятности будет <em>p</em> = 8 / 10 = 80%, что также является оценкой максимального правдоподобия. Вы также можете рассчитать доверительный интервал, чтобы увидеть, насколько эта оценка надёжна, но мы хотим пойти другим путём.</p>
<p>Представьте, что мы хотим учесть некоторые <strong>предварительные знания</strong> о вероятности <em>p</em>. Если вы, например, вытащили монету случайным образом из своего кошелька, нет причин думать, что монета смещена, поэтому <em>p</em> не должна быть слишком далеко от 50%, если вы, конечно, не фокусник.</p>
<p>С помощью байесовского моделирования вы можете учесть эти предварительные знания, чтобы получить оценку <em>плотности</em> <em>p</em>, то есть не одно значение, а целое распределение. Это распределение, скорее всего, будет иметь пик между оценкой максимального правдоподобия и предварительной оценкой, например, 65%.</p>
<h3 id="почему-моделирование-маркетингового-микса-с-помощью-байеса">Почему моделирование маркетингового микса с помощью Байеса?</h3>
<p>Вы можете определить модели маркетингового микса с большим количеством гиперпараметров:</p>
<ul>
<li>насыщенность;</li>
<li>сила переноса;</li>
<li>длина переноса и т. д.</li>
</ul>
<p>Затем вы можете использовать метод оптимизации гиперпараметров, чтобы найти оптимальную комбинацию. Я сделал это в своей другой статье о моделировании маркетингового микса, <strong>Усовершенствованное моделирование маркетингового микса в Python.</strong></p>
<p>Этот подход работает нормально, но есть одна вещь, которая мне не нравится:</p>
<blockquote>
<p>Оценки гиперпараметров часто нестабильны.</p>
</blockquote>
<p>Это означает, что совершенно разные наборы гиперпараметров могут давать одинаково хорошие модели.</p>
<p>Однако экстраполяция — это то, что нужно делать при оптимизации маркетингового бюджета. Если вы тратили от 0 € до 1 000 € в день на ТВ-рекламу в прошлом, для оптимизации вам нужно знать, что произойдёт, когда вы потратите 5 000 € или даже 10 000 €.</p>
<blockquote>
<p>Вам нужна модель с отличными возможностями экстраполяции.</p>
</blockquote>
<p>И обычно вам приходится выбирать между более чем двумя моделями. В этом случае вы можете действовать как минимум двумя способами:</p>
<ul>
<li>Вы можете выбрать первую модель, которую создадите, потому что вы даже не осознаёте проблему. Этот подход прост, но опасен.</li>
<li>Вы можете выбрать модель, которая <em>кажется вам правильной</em>, некоторым экспертам в предметной области или заинтересованным сторонам. Для некоторых людей это нормально, но я предпочитаю не закладывать в модель ожидания по выходу, потому что возникает следующий вопрос:</li>
</ul>
<blockquote>
<p><strong>Если кто-то уже знает ответ, зачем мне вообще строить модель, которая воспроизводит этот ответ?</strong></p>
</blockquote>
<h3 id="начало-моделирования">Начало моделирования</h3>
<p>Сначала давайте возьмём наш набор данных.</p>
<pre tabindex="0"><code>import pandas as pd

data = pd.read_csv(
  &#39;https://raw.githubusercontent.com/Garve/datasets/4576d323bf2b66c906d5130d686245ad205505cf/mmm.csv&#39;,
  parse_dates=[&#39;Date&#39;],
  index_col=&#39;Date&#39;
)

X = data.drop(columns=[&#39;Sales&#39;])
y = data[&#39;Sales&#39;]
</code></pre><p>Затем мы должны определить функции насыщения и переноса, аналогично предыдущей статье. На языке PyMC это может выглядеть так:</p>
<pre tabindex="0"><code>import pytensor.tensor as pt

def saturate(x, a):
    return 1 - pt.exp(-a*x)

def carryover(x, strength, length=21):
    w = pt.as_tensor_variable(
        [pt.power(strength, i) for i in range(length)]
    )

    x_lags = pt.stack(
        [pt.concatenate([
            pt.zeros(i),
            x[:x.shape[0]-i]
        ]) for i in range(length)]
    )

    return pt.dot(w, x_lags)
</code></pre><p>Функция насыщения должна быть простой для понимания. Перенос, однако, требует некоторой работы. В основном вы можете выразить преобразование переноса как умножение матрицы на вектор. Вам просто нужно сначала собрать матрицу <code>x_lags</code> и вектор <code>w</code>.</p>
<h3 id="анализ-выходных-данных-модели">Анализ выходных данных модели</h3>
<p>После этого мы можем посмотреть на обычные графики. Давайте начнём с <em>posterior</em> распределений. Выполнив</p>
<pre tabindex="0"><code>import arviz as az

az.plot_posterior(
    trace,
    var_names=[&#39;~contribution&#39;],
    filter_vars=&#39;like&#39;
)
</code></pre><p>вы получите</p>
<p>Здесь вы можете увидеть <em>posterior</em> для всех параметров. У всех них есть <em>унимодальная</em> (с одним пиком) форма. Вы также можете изучить, как пары переменных ведут себя вместе, с помощью</p>
<pre tabindex="0"><code>az.plot_pair(
    trace,
    var_names=[&#39;coef_TV&#39;, &#39;sat_TV&#39;],
    marginals=True
)
</code></pre><p>Здесь вы можете увидеть, что параметры насыщенности и коэффициент регрессии не являются независимыми, а отрицательно коррелированы: чем выше коэффициент, тем ниже параметр насыщенности имеет тенденцию быть. Это имеет смысл, потому что более высокий коэффициент может компенсировать более медленное увеличение кривой насыщения (= более низкий <code>sat_TV</code>) и наоборот.</p>
<p>Давайте посмотрим на другой график:</p>
<pre tabindex="0"><code>az.plot_pair(
    trace,
    var_names=[&#39;car_TV&#39;, &#39;sat_TV&#39;],
    marginals=True
)
</code></pre><p>Здесь мы видим, почему у оптимизации гиперпараметров могут быть проблемы. Каждая точка на этом графике — это потенциальная модель, которую вы могли бы найти с помощью оптимизации гиперпараметров.</p>
<p>Для действительно уникальной лучшей модели мы бы скорее увидели облако точек, плотно сконцентрированное вокруг одной точки (car_TV_true, sat_TV_true). Однако здесь мы видим, что сила переноса ТВ может иметь разумные значения от 0,4 до 0,5 в зависимости от параметра насыщенности.</p>
<p>Мы также должны проверить, хороша ли модель, прежде чем делать выводы. Выполнив</p>
<pre tabindex="0"><code>import matplotlib.pyplot as plt

with mmm:
    posterior = pm.sample_posterior_predictive(trace)

means = posterior.posterior_predictive[&#39;sales&#39;].mean(dim=[&#39;chain&#39;, &#39;draw&#39;])
stds = posterior.posterior_predictive[&#39;sales&#39;].std(dim=[&#39;chain&#39;, &#39;draw&#39;])

plt.figure(figsize=(20, 8))
plt.plot(y.values, linewidth=2, c=&#39;r&#39;, label=&#39;Observations&#39;)
plt.plot(means, linewidth=1, c=&#39;b&#39;, label=&#39;Mean prediction&#39;)
plt.fill_between(np.arange(len(y)), means - 2*stds, means + 2*stds, alpha=0.33)
plt.legend()
</code></pre><p>вы получите</p>
<p>так что похоже, что модель уловила что-то полезное.</p>
<h3 id="вклад-каналов">Вклад каналов</h3>
<p>Мы занимались распределениями, но для нашей любимой картинки с вкладом каналов давайте снова возьмём средние значения, чтобы получить одно значение. Поскольку мы ввели некоторые переменные вклада канала в код PyMC, мы можем легко извлечь их сейчас, используя короткую функцию <code>compute_mean</code>.</p>
<pre tabindex="0"><code>channels = [&#39;Banners&#39;, &#39;Radio&#39;, &#39;TV&#39;]
unadj_contributions = pd.DataFrame(
    {&#39;Base&#39;: trace.posterior[&#39;base&#39;].mean().values},
    index=X.index
)

for channel in channels:
    unadj_contributions[channel] = trace.posterior[f&#39;contribution_{channel}&#39;].mean(dim=[&#39;chain&#39;, &#39;draw&#39;]).values

adj_contributions = (unadj_contributions
                     .div(unadj_contributions.sum(axis=1), axis=0)
                     .mul(y, axis=0)
                    )

ax = (adj_contributions
      .plot.area(
          figsize=(16, 10),
          linewidth=1,
          title=&#39;Predicted Sales and Breakdown&#39;,
          ylabel=&#39;Sales&#39;,
          xlabel=&#39;Date&#39;
      )
     )

handles, labels = ax.get_legend_handles_labels()
ax.legend(
    handles[::-1], labels[::-1],
    title=&#39;Channels&#39;, loc=&#34;center left&#34;,
    bbox_to_anchor=(1.01, 0.5)
)
</code></pre><h3 id="резюме-и-перспективы">Резюме и перспективы</h3>
<p>В этой статье мы обсудили, что моделирование маркетингового микса с использованием подхода максимального правдоподобия может быть затруднено из-за оценки гиперпараметров. Может быть много моделей, которые хорошо работают на тестовом наборе, но имеют совершенно разное поведение при экстраполяции — параметры довольно нестабильны.</p>
<p>Однако правильная экстраполяция — это ключ к оптимизации. Поэтому мы разработали базовую модель маркетингового микса с эффектами насыщения и переноса в байесовской постановке. Это оказалось полезным, потому что позволяет одновременно оценить все параметры, давая нам более стабильные оценки.</p>
<p>Мы реализовали это с помощью PyMC и создали красивую диаграмму вкладов, чтобы увидеть, какой вклад в продажи внесли расходы на каналы.</p>
<h3 id="расширения-модели">Расширения модели</h3>
<p>Мы могли бы теперь взять байесовскую модель, которую мы создали, и расширить её ещё больше. Например, мы можем учесть изменение параметров во времени. Это может быть полезно, если сила переноса ТВ составляла 0,8 два года назад, но постепенно снизилась до 0,5 с течением времени, что является примером <em>дрейфа концепции</em>. Мы можем легко смоделировать это с помощью <strong>гауссовых случайных блужданий</strong>, как показано в моей другой статье о скользящей регрессии:</p>
<blockquote>
<p><strong>Скользящая регрессия в Python с помощью PyMC3</strong></p>
</blockquote>
<p>Таким же образом мы можем смоделировать изменение базовых показателей. До сих пор мы рассматривали базовый показатель как одно число, фиксированное на протяжении всего периода обучения. Но он мог также увеличиться со временем из-за наших стратегических усилий в области рекламы. Это трудно выяснить, используя наши старые модели максимального правдоподобия с оптимизацией гиперпараметров.</p>

    </div>

    <div class="tags mt-8">
      

    </div>
  </article>

          
            
  </main>          

    <script>

        
        
        const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
        const sidebar = document.querySelector('.sidebar');
        
        mobileMenuBtn.addEventListener('click', () => {
            sidebar.classList.toggle('open');
        });
        
        
        const observerOptions = {
            root: null,
            rootMargin: '0px',
            threshold: 0.5
        };
        
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                const id = entry.target.getAttribute('id');
                if (entry.isIntersecting) {
                    document.querySelectorAll(`.toc-link[href="#${id}"]`).forEach(link => {
                        link.classList.add('active');
                    });
                } else {
                    document.querySelectorAll(`.toc-link[href="#${id}"]`).forEach(link => {
                        link.classList.remove('active');
                    });
                }
            });
        }, observerOptions);
        
        
        document.querySelectorAll('h2[id]').forEach(heading => {
            observer.observe(heading);
        });
    </script>


  <footer class="px-6 py-12 bg-sky-950 text-white/50">
    
<p>P9X.ru 2010 - 2025г. услуги интернет маркетинга</p>

<script type="text/javascript">
    (function(m,e,t,r,i,k,a){
        m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();
        for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
        k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
    })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=105149615', 'ym');

    ym(105149615, 'init', {ssr:true, webvisor:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true});
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/105149615" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

  </footer>
</body>
</html>
