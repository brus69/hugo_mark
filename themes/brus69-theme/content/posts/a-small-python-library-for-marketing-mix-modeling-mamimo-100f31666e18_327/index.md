---
title: "–ù–µ–±–æ–ª—å—à–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –Ω–∞ Python –¥–ª—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤–æ–≥–æ –∫–æ–º–ø–ª–µ–∫—Å–∞: MaMiMo | –ù–∞ –ø—É—Ç–∏ –∫ –Ω–∞—É–∫–µ –æ –¥–∞–Ω–Ω—ã—Ö"
date: "2025-11-19T23:13:09+0000"
draft: true
description: ""
h1: "–ù–µ–±–æ–ª—å—à–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –Ω–∞ Python –¥–ª—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤–æ–≥–æ –∫–æ–º–ø–ª–µ–∫—Å–∞: MaMiMo"
urldel: "https://towardsdatascience.com/a-small-python-library-for-marketing-mix-modeling-mamimo-100f31666e18/"
---

### –ü—Ä–∏–≤–µ—Ç! –Ø –∑–∞–º–µ—Ç–∏–ª, —á—Ç–æ –ª—é–¥—è–º –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã –º–æ–∏ —Å—Ç–∞—Ç—å–∏ –æ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–∏ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤–æ–≥–æ –º–∏–∫—Å–∞, –ø–æ—ç—Ç–æ–º—É —è —Å–æ–∑–¥–∞–ª –¥–ª—è –≤–∞—Å –Ω–µ–±–æ–ª—å—à—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–º–æ–∂–µ—Ç –≤–∞–º —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –ø—Ä–æ—Å—Ç—ã–µ –º–æ–¥–µ–ª–∏ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤–æ–≥–æ –º–∏–∫—Å–∞! –í —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ —è –ø–æ–∫–∞–∂—É –≤–∞–º, –∫–∞–∫ –µ—ë –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å.

> _**‚ö† –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ ‚ö†:** —è —Å—Ç–∞—Ä–∞–ª—Å—è —Å–¥–µ–ª–∞—Ç—å —ç—Ç—É –±–∏–±–ª–∏–æ—Ç–µ–∫—É –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –Ω–∞–¥—ë–∂–Ω–æ–π –∏ –±–µ–∑ –æ—à–∏–±–æ–∫. –û–¥–Ω–∞–∫–æ –æ—à–∏–±–∫–∏ –≤—Å—ë —Ä–∞–≤–Ω–æ –º–æ–≥—É—Ç –±—ã—Ç—å, –ø–æ—ç—Ç–æ–º—É –≤—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–æ–¥–∏—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫—É —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –ø–æ—Å–ª–µ, –ø—Ä–µ–∂–¥–µ —á–µ–º —Å–æ–æ–±—â–∞—Ç—å –æ —á—ë–º-–ª–∏–±–æ –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω–Ω—ã–º —Å—Ç–æ—Ä–æ–Ω–∞–º. –ï—Å–ª–∏ –≤—ã –æ–±–Ω–∞—Ä—É–∂–∏—Ç–µ –æ—à–∏–±–∫—É –∏–ª–∏ –∑–∞–ø—Ä–æ—Å–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é, –ø—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–∏—Ç–µ –º–Ω–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–ª–∏ ‚Äî –µ—â—ë –ª—É—á—à–µ ‚Äî —Å–æ–∑–¥–∞–π—Ç–µ –∑–∞–ø—Ä–æ—Å –Ω–∞ –≤–∫–ª—é—á–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ GitHub! üòâ_

---

–ï—Å–ª–∏ –≤—ã –Ω–µ –∑–Ω–∞–µ—Ç–µ, —á—Ç–æ —Ç–∞–∫–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤–æ–≥–æ –º–∏–∫—Å–∞, –ø—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –≤—ã —Ä–∞–±–æ—Ç–∞–µ—Ç–µ –≤ –∫–æ–º–ø–∞–Ω–∏–∏, –∫–æ—Ç–æ—Ä–∞—è —á—Ç–æ-—Ç–æ –ø—Ä–æ–¥–∞—ë—Ç. –ß—Ç–æ–±—ã –ø—Ä–æ–¥–∞–≤–∞—Ç—å –µ—â—ë –±–æ–ª—å—à–µ, –≤—ã –¥–µ–ª–∞–µ—Ç–µ —Ä–µ–∫–ª–∞–º—É. –í –∫–∞–∫–æ–π-—Ç–æ –º–æ–º–µ–Ω—Ç –≤—ã —Ö–æ—Ç–∏—Ç–µ –∑–Ω–∞—Ç—å, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ö–æ—Ä–æ—à–æ –≤–∞—à–∞ —Ä–µ–∫–ª–∞–º–∞ —Ä–∞–±–æ—Ç–∞–ª–∞ –ø–æ –∫–∞–Ω–∞–ª–∞–º, —Ç–æ –µ—Å—Ç—å –¢–í, —Ä–∞–¥–∏–æ, –≤–µ–±-–±–∞–Ω–Ω–µ—Ä—ã –∏ —Ç. –¥., –∏ –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –≤—Ä–æ–¥–µ: ¬´–≠—Ç–∏ 1000 ‚Ç¨, –∫–æ—Ç–æ—Ä—ã–µ —è –≤–ª–æ–∂–∏–ª –≤ —Ä–µ–∫–ª–∞–º—É –Ω–∞ –¢–í –Ω–∞ —Ç–æ–π –Ω–µ–¥–µ–ª–µ, –Ω–∞ —Å–∫–æ–ª—å–∫–æ –æ–Ω–∏ —É–≤–µ–ª–∏—á–∏–ª–∏ –º–æ–π –¥–æ—Ö–æ–¥?¬ª. –ú–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤–æ–≥–æ –º–∏–∫—Å–∞ ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ. –í—ã –º–æ–∂–µ—Ç–µ –Ω–∞–π—Ç–∏ –±–æ–ª—å—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ –º–æ–∏—Ö —Å—Ç–∞—Ç—å—è—Ö –æ–± —ç—Ç–æ–º:

> **–í–≤–µ–¥–µ–Ω–∏–µ –≤ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤–æ–≥–æ –º–∏–∫—Å–∞ –Ω–∞ Python**
>
> **–ú–æ–¥–µ—Ä–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤–æ–≥–æ –º–∏–∫—Å–∞ –Ω–∞ Python**

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞, –∫–æ—Ç–æ—Ä—É—é —è —Å–æ–∑–¥–∞–ª, –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è **MaMiMo**, –∏ –µ—Å–ª–∏ –≤—ã —É–º–µ–µ—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è scikit-learn, –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏ —ç—Ç—É. –î–∞–≤–∞–π—Ç–µ –Ω–∞—á–Ω—ë–º —Å –ø—Ä–æ—Å—Ç–æ–≥–æ:

`pip install mamimo`

## –ù–µ–±–æ–ª—å—à–æ–π –ø—Ä–∏–º–µ—Ä

–ï—Å–ª–∏ –≤—ã –ø—Ä–æ—á–∏—Ç–∞–ª–∏ –æ–±–µ —Å—Ç–∞—Ç—å–∏ —Å–≤–µ—Ä—Ö—É ‚Äî —á—Ç–æ —è –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞—é —Å–µ–π—á–∞—Å ‚Äî –≤—ã, –Ω–∞–≤–µ—Ä–Ω–æ–µ, –ø–æ–º–Ω–∏—Ç–µ, —á—Ç–æ –º—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ —Ç–∞–º –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö. –ó–∞—Ç–µ–º –º—ã –æ–ø—Ä–µ–¥–µ–ª–∏–ª–∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –Ω–∞—Å—ã—â–µ–Ω–∏—è –∏ –ø–µ—Ä–µ–Ω–æ—Å–∞ –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤–æ–≥–æ –º–∏–∫—Å–∞. –Ø –ø–æ–º–µ—Å—Ç–∏–ª –≤ MaMiMo –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π, –Ω–æ –Ω–µ–º–Ω–æ–≥–æ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–π –ø—Ä–∏–º–µ—Ä –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ–±—ã –≤—ã –Ω–∞—á–∞–ª–∏:

```
from mamimo.datasets import load_fake_mmm

data = load_fake_mmm()

X = data.drop(columns=['Sales'])
y = data['Sales']
```

–≠—Ç–æ –¥–∞—ë—Ç –Ω–∞–º –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö —Å –∏–Ω–¥–µ–∫—Å–æ–º –¥–∞—Ç—ã –Ω–∞ –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ–π –æ—Å–Ω–æ–≤–µ, —Ç—Ä–µ–º—è –º–µ–¥–∏–∞–∫–∞–Ω–∞–ª–∞–º–∏ –∏ —Å—Ç–æ–ª–±—Ü–æ–º –ø—Ä–æ–¥–∞–∂, –∫–æ—Ç–æ—Ä—ã–π –º—ã —Ö–æ—Ç–∏–º –æ–±—ä—è—Å–Ω–∏—Ç—å.

### –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

–ú—ã –º–æ–∂–µ–º –Ω–∞–ø—Ä—è–º—É—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —ç—Ç–æ—Ç –∫–æ–Ω–≤–µ–π–µ—Ä, –∏—Å–ø–æ–ª—å–∑—É—è –ø–æ–¥–º–æ–¥—É–ª–∏ –ø–µ—Ä–µ–Ω–æ—Å–∞ –∏ –Ω–∞—Å—ã—â–µ–Ω–∏—è –∏–∑ MaMiMo, –∞ —Ç–∞–∫–∂–µ –µ–≥–æ `LinearRegression`, –∫–æ—Ç–æ—Ä—ã–π –±–æ–ª–µ–µ –≥–∏–±–∫–∏–π, —á–µ–º –≤–µ—Ä—Å–∏—è scikit-learn. –ß—Ç–æ –Ω–∞–º –Ω—É–∂–Ω–æ –æ—Ç scikit-learn, —Ç–∞–∫ —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –∫–æ–Ω–≤–µ–π–µ—Ä–∞.

```
from mamimo.carryover import ExponentialCarryover
from mamimo.saturation import ExponentialSaturation
from mamimo.linear_model import LinearRegression
from sklearn.compose import ColumnTransformer
from sklearn.pipeline import Pipeline

adstock = ColumnTransformer(
    [
        ('tv_pipe', Pipeline([
            ('carryover', ExponentialCarryover()),
            ('saturation', ExponentialSaturation())
        ]), ['TV']),
        ('radio_pipe', Pipeline([
            ('carryover', ExponentialCarryover()),
            ('saturation', ExponentialSaturation())
        ]), ['Radio']),
        ('banners_pipe', Pipeline([
            ('carryover', ExponentialCarryover()),
            ('saturation', ExponentialSaturation())
        ]), ['Banners']),
    ]
)

model = Pipeline([
    ('adstock', adstock),
    ('regression', LinearRegression(positive=True))
])
```

–≠—Ç–æ –¥–∞—ë—Ç –º–æ–¥–µ–ª—å, –∫–æ—Ç–æ—Ä–∞—è —Å–∞–º–∞ –ø–æ —Å–µ–±–µ –Ω–µ –æ—á–µ–Ω—å —Ö–æ—Ä–æ—à–∞, –ø–æ—Ç–æ–º—É —á—Ç–æ –µ–π –≤—Å—ë –µ—â—ë –Ω—É–∂–Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.

```
print(model.fit(X, y).score(X, y))
```

–î–∞–∂–µ –æ–±—É—á–µ–Ω–∏–µ –∏ –æ—Ü–µ–Ω–∫–∞ –Ω–∞ –æ–¥–Ω–æ–º –∏ —Ç–æ–º –∂–µ –Ω–∞–±–æ—Ä–µ **(–Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –¥–µ–ª–∞–π—Ç–µ —ç—Ç–æ–≥–æ –≤ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ)** –¥–∞—é—Ç –¥–æ–≤–æ–ª—å–Ω–æ **–ø–ª–æ—Ö–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç** ‚Äî –º—ã –Ω–µ–¥–æ–æ–±—É—á–∏–ª–∏ –º–æ–¥–µ–ª—å. –ò—Ç–∞–∫, –¥–∞–≤–∞–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–∏–º –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã.

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

–î–∞–≤–∞–π—Ç–µ —Å–µ–≥–æ–¥–Ω—è –≤–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è `RandomSearchCV` –∏–∑ sklearn –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤. –ú—ã –±—É–¥–µ–º –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞—Å—ã—â–µ–Ω–∏—è –∏ —Å–∏–ª—É –∏ –¥–ª–∏–Ω—É –ø–µ—Ä–µ–Ω–æ—Å–∞ –¥–ª—è –≤—Å–µ—Ö –∫–∞–Ω–∞–ª–æ–≤ –æ—Ç–¥–µ–ª—å–Ω–æ. –í—ã –º–æ–∂–µ—Ç–µ –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ **–¥–ª–∏–Ω–µ –ø–µ—Ä–µ–Ω–æ—Å–∞ —Ä–∞–¥–∏–æ** —á–µ—Ä–µ–∑ `adstock__radio_pipe__carryover__window`, –Ω–∞–ø—Ä–∏–º–µ—Ä.

```
from scipy.stats import uniform, randint
from sklearn.model_selection import RandomizedSearchCV, TimeSeriesSplit

tuned_model = RandomizedSearchCV(
    model,
    param_distributions={
        'adstock__tv_pipe__carryover__window': randint(1, 10),
        'adstock__tv_pipe__carryover__strength': uniform(0, 1),
        'adstock__tv_pipe__saturation__exponent': uniform(0, 1),
        'adstock__radio_pipe__carryover__window': randint(1, 10),
        'adstock__radio_pipe__carryover__strength': uniform(0, 1),
        'adstock__radio_pipe__saturation__exponent': uniform(0, 1),
        'adstock__banners_pipe__carryover__window': randint(1, 10),
        'adstock__banners_pipe__carryover__strength': uniform(0, 1),
        'adstock__banners_pipe__saturation__exponent': uniform(0,1),
    },
    cv=TimeSeriesSplit(),
    random_state=0,
    n_iter=100
)
```

–ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è –º—ã –º–æ–∂–µ–º –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ª—É—á—à–∏–µ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

```
print(tuned_model.best_params_)
```

–ò—Ç–∞–∫, –º–æ–¥–µ–ª—å —Å—á–∏—Ç–∞–µ—Ç, —á—Ç–æ —ç—Ñ—Ñ–µ–∫—Ç –ø–µ—Ä–µ–Ω–æ—Å–∞ –¢–í –¥–ª–∏—Ç—Å—è —á–µ—Ç—ã—Ä–µ –Ω–µ–¥–µ–ª–∏, –ø—Ä–∏–º–µ—Ä–Ω–æ —Å 4,68% —ç—Ñ—Ñ–µ–∫—Ç–∞, –ø–µ—Ä–µ–Ω–æ—Å–∏–º–æ–≥–æ –≤ —Å–ª–µ–¥—É—é—â—É—é –Ω–µ–¥–µ–ª—é, –Ω–∞–ø—Ä–∏–º–µ—Ä. –ü–æ–¥–æ–±–Ω—ã–µ –∑–∞—è–≤–ª–µ–Ω–∏—è ‚Äî –∑–æ–ª–æ—Ç–æ –¥–ª—è –±–∏–∑–Ω–µ—Å–∞.

> –≠—Ç–æ—Ç –≤—ã–≤–æ–¥ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–∞–º –æ–±—ä—è—Å–Ω–∏—Ç—å –≤–∞—à—É –º–æ–¥–µ–ª—å –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω–Ω—ã–º —Å—Ç–æ—Ä–æ–Ω–∞–º –ø—Ä–æ—Å—Ç—ã–º –∏ –ø–æ–Ω—è—Ç–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º.

–¢–µ–º –Ω–µ –º–µ–Ω–µ–µ –º–æ–¥–µ–ª—å —É–∂–∞—Å–Ω–∞, –ø–æ—ç—Ç–æ–º—É —è –±—ã –Ω–µ —Å—Ç–∞–ª –¥–æ–≤–µ—Ä—è—Ç—å –Ω–∞–π–¥–µ–Ω–Ω—ã–º –ø–æ–∫–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º.

### –í–∫–ª—é—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫

–Ø —Ç–∞–∫–∂–µ –¥–æ–±–∞–≤–∏–ª –Ω–µ—Å–∫–æ–ª—å–∫–æ —É–¥–æ–±–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫. –ü—Ä–æ—Å—Ç–æ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ —ç—Ç–æ:

```
from mamimo.time_utils import add_time_features, add_date_indicators

X = (X
     .pipe(add_time_features, month=True)
     .pipe(add_date_indicators, special_date=["2020-01-05"])
     .assign(trend=range(200))
)
```

–≠—Ç–æ –¥–æ–±–∞–≤–ª—è–µ—Ç:

* —Å—Ç–æ–ª–±–µ—Ü –º–µ—Å—è—Ü–∞ (—Ü–µ–ª—ã–µ —á–∏—Å–ª–∞ –æ—Ç 1 –¥–æ 12),
* –¥–≤–æ–∏—á–Ω—ã–π —Å—Ç–æ–ª–±–µ—Ü —Å –∏–º–µ–Ω–µ–º `special_date`, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–≤–µ–Ω 1 5 —è–Ω–≤–∞—Ä—è 2020 –≥–æ–¥–∞ –∏ 0 –≤–µ–∑–¥–µ else, –∏
* –ª–∏–Ω–µ–π–Ω—ã–π —Ç—Ä–µ–Ω–¥, –∫–æ—Ç–æ—Ä—ã–π —Ç–æ–ª—å–∫–æ —Å—á–∏—Ç–∞–µ—Ç –æ—Ç 0 –¥–æ 199.

–í—Å–µ —ç—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ —É—Ç–æ—á–Ω—è—é—Ç—Å—è –≤ –º–æ–º–µ–Ω—Ç, –∫–æ–≥–¥–∞ –º—ã —Å—Ç—Ä–æ–∏–º —Å–ª–µ–¥—É—é—â—É—é –º–æ–¥–µ–ª—å. –í –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∫ –º–µ–¥–∏–∞–∫–∞–Ω–∞–ª–∞–º –º—ã —Å–¥–µ–ª–∞–µ–º —Å–ª–µ–¥—É—é—â—É—é –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫—É –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π:

* –º–µ—Å—è—Ü –ø–æ–ª—É—á–∞–µ—Ç –æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ;
* –ª–∏–Ω–µ–π–Ω—ã–π —Ç—Ä–µ–Ω–¥ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤–æ–∑–≤–µ–¥—ë–Ω –≤ –Ω–µ–∫–æ—Ç–æ—Ä—É—é —Å—Ç–µ–ø–µ–Ω—å, –Ω–∞–ø—Ä–∏–º–µ—Ä —Ç—Ä–µ–Ω–¥¬≤ –¥–ª—è —Ç—Ä–µ–Ω–¥–∞, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞—Å—Ç—ë—Ç –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ (–±–∏–∑–Ω–µ—Å –±—ã–ª –±—ã —Å—á–∞—Å—Ç–ª–∏–≤);
* —Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –¥–∞—Ç–∞ –º–æ–∂–µ—Ç –∏–º–µ—Ç—å —ç—Ñ—Ñ–µ–∫—Ç –ø–µ—Ä–µ–Ω–æ—Å–∞, —Ç–æ –µ—Å—Ç—å –º—ã –≥–æ–≤–æ—Ä–∏–º, —á—Ç–æ –≤–∞–∂–Ω–∞ –Ω–µ —Ç–æ–ª—å–∫–æ –Ω–µ–¥–µ–ª—è 5 —è–Ω–≤–∞—Ä—è 2020 –≥–æ–¥–∞, –Ω–æ –∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –Ω–µ–¥–µ–ª–∏ –ø–æ—Å–ª–µ –Ω–µ—ë, –ø–æ —Ç–æ–π –∂–µ –ª–æ–≥–∏–∫–µ, —á—Ç–æ –∏ –¥–ª—è –ø–µ—Ä–µ–Ω–æ—Å–∞ –≤ –º–µ–¥–∏–∞–∫–∞–Ω–∞–ª–∞—Ö.

```
from mamimo.time_utils import PowerTrend
from mamimo.carryover import ExponentialCarryover
from mamimo.saturation import ExponentialSaturation
from sklearn.linear_model import LinearRegression
from sklearn.preprocessing import OneHotEncoder
from sklearn.compose import ColumnTransformer
from sklearn.pipeline import Pipeline

cats =  [list(range(1, 13))] 

preprocess = ColumnTransformer(
    [
        ('tv_pipe', Pipeline([
            ('carryover', ExponentialCarryover()),
            ('saturation', ExponentialSaturation())
        ]), ['TV']),
        ('radio_pipe', Pipeline([
            ('carryover', ExponentialCarryover()),
            ('saturation', ExponentialSaturation())
        ]), ['Radio']),
        ('banners_pipe', Pipeline([
            ('carryover', ExponentialCarryover()),
            ('saturation', ExponentialSaturation())
        ]), ['Banners']),
        ('month', OneHotEncoder(sparse=False, categories=cats), ['month']),
        ('trend', PowerTrend(), ['trend']),
        ('special_date', ExponentialCarryover(), ['special_date'])
    ]
)

new_model = Pipeline([
    ('preprocess', preprocess),
    ('regression', LinearRegression(
        positive=True,
        fit_intercept=False) 
    )
])
```

–§–∏—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —ç—Ç–æ–π –≤—Å—ë –µ—â—ë –Ω–µ–Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≥–æ—Ä–∞–∑–¥–æ –ª—É—á—à—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:

### –ü–æ—Å–ª–µ–¥–Ω—è—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

–î–∞–≤–∞–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–∏–º –Ω–æ–≤—ã–µ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã. –í–æ–∑–º–æ–∂–Ω–æ, –ª–∏–Ω–µ–π–Ω—ã–π —Ç—Ä–µ–Ω–¥ ‚Äî —ç—Ç–æ –Ω–µ –ª—É—á—à–µ–µ, —á—Ç–æ –º—ã –º–æ–∂–µ–º —Å–¥–µ–ª–∞—Ç—å. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –ø–æ–∫–∞ —á—Ç–æ –ø–µ—Ä–µ–Ω–æ—Å–∞ –Ω–µ—Ç, –ø–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è `ExponentialCarryover`, –µ—Å–ª–∏ –≤—ã –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç–µ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã. –ú—ã —Å–æ–∑–¥–∞–¥–∏–º –µ—â—ë –æ–¥–Ω—É –Ω–∞—Å—Ç—Ä–æ–π–∫—É –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:

```
from scipy.stats import randint, uniform
from sklearn.model_selection import RandomizedSearchCV, TimeSeriesSplit

tuned_new_model = RandomizedSearchCV(
    new_model,
    param_distributions={
        'preprocess__tv_pipe__carryover__window': randint(1, 10),
        'preprocess__tv_pipe__carryover__strength': uniform(0, 1),
        'preprocess__tv_pipe__saturation__exponent': uniform(0, 1),
        'preprocess__radio_pipe__carryover__window': randint(1, 10),
        'preprocess__radio_pipe__carryover__strength': uniform(0,1),
        'preprocess__radio_pipe__saturation__exponent': uniform(0, 1),
        'preprocess__banners_pipe__carryover__window': randint(1, 10),
        'preprocess__banners_pipe__carryover__strength': uniform(0, 1),
        'preprocess__banners_pipe__saturation__exponent': uniform(0, 1),
        'preprocess__trend__power': uniform(0, 2),           
        'preprocess__special_date__window': randint(1, 10),  
        'preprocess__special_date__strength': uniform(0, 1), 
    },
    cv=TimeSeriesSplit(),
    random_state=0,
    n_iter=1000, 
)

tuned_model.fit(X, y)
```

### –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –≤–∫–ª–∞–¥–∞ –∫–∞–Ω–∞–ª–æ–≤

–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ —É –Ω–∞—Å –µ—Å—Ç—å –æ–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å, –º—ã —Ö–æ—Ç–∏–º –∑–Ω–∞—Ç—å, –∫–∞–∫–æ–π –≤–∫–ª–∞–¥ –∫–∞–∂–¥—ã–π –∫–∞–Ω–∞–ª –≤–Ω—ë—Å –≤ –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–µ –ø—Ä–æ–¥–∞–∂–∏. –î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —è —Å–æ–∑–¥–∞–ª —Ñ—É–Ω–∫—Ü–∏—é `breakdown`, —á—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ.

```
from mamimo.analysis import breakdown

contributions = breakdown(tuned_new_model.best_estimator_, X, y)
ax = contributions.plot.area(
    figsize=(16, 10),
    linewidth=1,
    title="Predicted Sales and Breakdown",
    ylabel="Sales",
    xlabel="Date",
)

handles, labels = ax.get_legend_handles_labels()
ax.legend(
    handles[::-1],
    labels[::-1],
    title="Channels",
    loc="center left",
    bbox_to_anchor=(1.01, 0.5),
)
```

### –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –≤–æ–∑–≤—Ä–∞—Ç–∞ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π

–Ø –Ω–µ —Å–æ–∑–¥–∞–≤–∞–ª –¥–ª—è —ç—Ç–æ–≥–æ —É–¥–æ–±–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é (–ø–æ–∫–∞?), –Ω–æ –≤—ã –º–æ–∂–µ—Ç–µ —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å ROI –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–∞–Ω–∞–ª–∞ —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

```
for channel in ['TV', 'Radio', 'Banners']:
    roi = contributions[channel].sum() / X[channel].sum()
    print(f'{channel}: {roi:.2f}')
```

### –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–Ø –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–ª –≤–∞–º —Å–≤–æ—é –Ω–æ–≤—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É MaMiMo, —á—Ç–æ–±—ã –æ–±–ª–µ–≥—á–∏—Ç—å –≤–∞—à—É –∂–∏–∑–Ω—å –ø—Ä–∏ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–∏ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤–æ–≥–æ –º–∏–∫—Å–∞. –û–Ω–∞ —Ö–æ—Ä–æ—à–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è —Å scikit-learn –∏ –ø–æ–¥–æ–±–Ω—ã–º–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º–∏ –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–∞–º –¥–µ–ª–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –≤–µ—â–∏ (–ø–æ–∫–∞!):

* –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –Ω–∞—Å—ã—â–µ–Ω–∏—è (—ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ, –•–∏–ª–ª–∞, Adbudg, BoxCox);
* –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –ø–µ—Ä–µ–Ω–æ—Å—ã (—ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ, –≥–∞—É—Å—Å–æ–≤—Å–∫–∏–µ);
* –¥–æ–±–∞–≤–ª—è—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ (–¥–µ–Ω—å, –º–µ—Å—è—Ü, –Ω–µ–¥–µ–ª—è –º–µ—Å—è—Ü–∞, ‚Ä¶, —Ç—Ä–µ–Ω–¥);
* –∏–∑–º–µ–Ω—è—Ç—å —Ç—Ä–µ–Ω–¥;
* –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –º–æ–¥–µ–ª—å, –ø—Ä–æ–≤–µ—Ä—è—è –≤–∫–ª–∞–¥ –∫–∞–Ω–∞–ª–æ–≤.

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –µ—ë —á–µ—Ä–µ–∑ `pip install mamimo`!

–°–ø–∞—Å–∏–±–æ –∑–∞ —á—Ç–µ–Ω–∏–µ!

