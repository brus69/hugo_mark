---
title: "Понимание байесовского моделирования комплекса маркетинга: Глубокое погружение в предыдущие спецификации | На пути к науке о данных"
date: "2025-11-19T23:13:09+0000"
draft: true
description: ""
h1: "Понимание байесовского моделирования комплекса маркетинга: Глубокое погружение в предыдущие спецификации"
urldel: "https://towardsdatascience.com/understanding-bayesian-marketing-mix-modeling-a-deep-dive-into-prior-specifications-af400adb836e/"
---

### Моделирование байесовского маркетингового микса получает всё больше внимания

Фото от Павела Червински на Unsplash.

Моделирование маркетингового микса с использованием байесовских методов привлекает всё больше внимания, особенно с недавним выпуском инструментов с открытым исходным кодом, таких как LightweightMMM (Google) или PyMC Marketing (PyMC Labs). Хотя эти фреймворки упрощают сложности байесовского моделирования, всё ещё крайне важно для пользователя понимать фундаментальные байесовские концепции и уметь интерпретировать спецификацию модели.

В этой статье я использую Google’s LightweightMMM в качестве практического примера и показываю интуицию и смысл предварительных спецификаций этого фреймворка. Я демонстрирую моделирование предварительных образцов с помощью Python и библиотеки scipy.

#### Данные

Я использую данные, предоставленные Robyn под лицензией MIT.

Набор данных состоит из 208 недель выручки (с 2015–11–23 по 2019–11–11) и включает:

* 5 каналов расходов на медиа: **tv_S, ooh_S, print_S, facebook_S, search_S**;
* 2 канала медиа, которые также имеют информацию об экспозиции (Impression, Clicks): facebook_I, search_clicks_P;
* Органические медиа без расходов: **newsletter**;
* Контрольные переменные: **events, holidays**, продажи конкурентов (**competitor_sales_B**).

#### Спецификация модели LightweightMMM

Спецификация модели LightweightMMM определяется следующим образом:

Эта спецификация представляет аддитивную линейную регрессионную модель, которая объясняет значение отклика (целевой переменной) в определённый момент времени _t_.

Давайте разберём каждый компонент в уравнении:

* _**α**_: этот компонент представляет точку пересечения или базовое значение отклика. Это ожидаемое значение отклика, когда все остальные факторы равны нулю.
* _**trend**_: этот компонент отражает увеличивающийся или уменьшающийся тренд отклика с течением времени.
* _**seasonality**_: этот компонент представляет периодические колебания отклика.
* _**media_channels**_: этот компонент учитывает влияние каналов медиа (телевидение, радио, онлайн-реклама) на отклик.
* _**other_factors**_: этот компонент включает любые другие переменные, которые влияют на отклик, такие как погода, экономические показатели или активность конкурентов.

Ниже я подробно рассматриваю каждый из компонентов и объясняю, как интерпретировать предварительные спецификации. Напомню, что предварительное распределение — это предполагаемое распределение некоторого параметра без каких-либо знаний об исходных данных.

### Перехват

Предварительная спецификация перехвата определена как полунормальное распределение со стандартным отклонением 2. Полунормальное распределение — это непрерывное распределение вероятностей, которое напоминает нормальное распределение, но ограничено только положительными значениями. Распределение характеризуется одним параметром — стандартным отклонением (масштабом). Полунормальное распределение подразумевает, что перехват может принимать только положительные значения.

Следующий код генерирует выборки из предварительного распределения перехвата и визуализирует функцию плотности вероятности (PDF) для полунормального распределения с масштабом 2. Для визуализации других компонентов, пожалуйста, обратитесь к сопровождающему исходному коду в репозитории Github.

```
from scipy import stats

scale = 2
halfnormal_dist = stats.halfnorm(scale=scale)
samples = halfnormal_dist.rvs(size=1000)

plt.figure(figsize=(20, 6))
sns.histplot(samples, bins=50, kde=False, stat='density', alpha=0.5)
sns.lineplot(x=np.linspace(0, 6, 100), 
          y=halfnormal_dist.pdf(np.linspace(0, 6, 100)), color='r')

plt.title(f"Half-Normal Distribution with scale={scale}")
plt.xlabel('x')
plt.ylabel('P(X=x)')
plt.show()
```

### Тренд

Спецификация тренда определена как степенная зависимость между временем _t_ и значением тренда. Параметр _μ_ представляет амплитуду или величину тренда, а _k_ контролирует крутизну или кривизну тренда.

Параметр _μ_ извлекается из нормального распределения со средним значением 0 и стандартным отклонением 1. Это означает, что _μ_ следует стандартному нормальному распределению, центрированному вокруг 0, со стандартным отклонением 1. Нормальное распределение допускает положительные и отрицательные значения _μ_, представляющие восходящие и нисходящие тренды соответственно.

Параметр _k_ извлекается из равномерного распределения между 0,5 и 1,5. Равномерное распределение гарантирует, что _k_ принимает значения, которые приводят к разумной и значимой кривизне тренда.

### Сезонность

Каждый компонент γ извлекается из нормального распределения со средним значением 0 и стандартным отклонением 1.

Комбинируя косинусную и синусоидальную функции с разными γ, можно смоделировать циклические закономерности для учёта сезонности, присутствующей в данных. Косинусная и синусоидальная функции представляют колебательное поведение, наблюдаемое в течение периода в 52 единицы (недели).

### Другие факторы (контрольные переменные)

Каждый коэффициент фактора _λ_ извлекается из нормального распределения со средним значением 0 и стандартным отклонением 1, что означает, что _λ_ может принимать положительные или отрицательные значения, представляющие направление и величину влияния каждого фактора на результат.

### Каналы медиа

Распределение для коэффициента _β_ канала медиа _m_ задано как полунормальное распределение, где параметр стандартного отклонения _v_ определяется суммой общих затрат, связанных с каналом медиа _m_. Общие затраты отражают инвестиции или ресурсы, выделенные на этот конкретный канал медиа.

### Трансформации медиа

В этих уравнениях мы моделируем поведение каналов медиа с помощью серии преобразований, таких как adstock и насыщение Хилла.

#### Моделирование маркетингового микса с использованием PyMC3

Переменная _каналы медиа_ представляет преобразованные каналы медиа в момент времени _t_. Она получается путём применения преобразования к исходному значению канала медиа _x_. Преобразование Хилла контролируется параметрами _K_ — точкой половинного насыщения (0 < k ≤ 1) и формой _S_, контролирующей крутизну кривой (s > 0).

Переменная _x_ ∗​ представляет значение преобразованных каналов медиа в момент времени _t_ после прохождения преобразования adstock. Оно рассчитывается путём сложения текущего исходного значения канала медиа с произведением предыдущего преобразованного значения и параметра затухания adstock _λ_.

Параметры _K_ и _S_ следуют гамма-распределениям с формой и масштабными параметрами, равными 1, а _λ_ следует бета-распределению с формой параметров 2 и 1.

### Заключение

Моделирование байесовского маркетингового микса может потребовать значительного времени для освоения. Я надеюсь, что эта статья помогла вам улучшить понимание предварительных распределений и байесовских спецификаций маркетинговых моделей.

Полный код можно скачать из моего репозитория на Github.

Спасибо за чтение!

