---
title: "–ö–∞–∫ –æ—Ü–µ–Ω–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –ø–æ–∏—Å–∫–∞ –≤ –∫–æ–Ω–≤–µ–π–µ—Ä–∞—Ö RAG: Precision@k, Recall@k –∏ F1@k | –ù–∞ –ø—É—Ç–∏ –∫ –Ω–∞—É–∫–µ –æ –¥–∞–Ω–Ω—ã—Ö"
date: "2025-11-19T22:53:35+0000"
draft: false
description: ""
h1: "–ö–∞–∫ –æ—Ü–µ–Ω–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –≤ —Ç—Ä—É–±–æ–ø—Ä–æ–≤–æ–¥–∞—Ö RAG: –¢–æ—á–Ω–æ—Å—Ç—å @k, –æ—Ç–∑—ã–≤@k –∏ F1@k"
urldel: "https://towardsdatascience.com/how-to-evaluate-retrieval-quality-in-rag-pipelines-precisionk-recallk-and-f1k/"
---

### –Ø –ø—Ä–æ—à—ë–ª —Å –≤–∞–º–∏ –ø—É—Ç—å —Å–æ–∑–¥–∞–Ω–∏—è –±–∞–∑–æ–≤–æ–≥–æ –∫–æ–Ω–≤–µ–π–µ—Ä–∞ RAG –Ω–∞ Python, –∞ —Ç–∞–∫–∂–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –±–æ–ª—å—à–∏—Ö —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –Ω–∞ —á–∞—Å—Ç–∏. –ú—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–ª–∏, –∫–∞–∫ –¥–æ–∫—É–º–µ–Ω—Ç—ã –ø—Ä–µ–æ–±—Ä–∞–∑—É—é—Ç—Å—è –≤ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –±—ã—Å—Ç—Ä–æ –∏—Å–∫–∞—Ç—å –ø–æ—Ö–æ–∂–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –≤ –≤–µ–∫—Ç–æ—Ä–Ω–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, –∞ —Ç–∞–∫–∂–µ –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–µ—Ä–µ—Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –∑–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

–ò—Ç–∞–∫, —Ç–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ –º—ã –ø–æ–ª—É—á–∏–ª–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã, –ø—Ä–∏—à–ª–æ –≤—Ä–µ–º—è –ø–µ—Ä–µ–¥–∞—Ç—å –∏—Ö –≤ LLM –¥–ª—è —ç—Ç–∞–ø–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏. –ù–æ –ø—Ä–µ–∂–¥–µ –≤–∞–∂–Ω–æ —É–º–µ—Ç—å –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å, —Ö–æ—Ä–æ—à–æ –ª–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∏ –º–æ–∂–µ—Ç –ª–∏ –æ–Ω —É—Å–ø–µ—à–Ω–æ –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã. –í –∫–æ–Ω—Ü–µ –∫–æ–Ω—Ü–æ–≤, –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤, —Å–æ–¥–µ—Ä–∂–∞—â–∏—Ö –æ—Ç–≤–µ—Ç –Ω–∞ –∑–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, ‚Äî —ç—Ç–æ –ø–µ—Ä–≤—ã–π —à–∞–≥ –∫ —Å–æ–∑–¥–∞–Ω–∏—é –æ—Å–º—ã—Å–ª–µ–Ω–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞.

–ü–æ—ç—Ç–æ–º—É –∏–º–µ–Ω–Ω–æ —ç—Ç–æ –º—ã –∏ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –≤ —Å–µ–≥–æ–¥–Ω—è—à–Ω–µ–º –ø–æ—Å—Ç–µ. –í —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–∑ –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫ –¥–ª—è –æ—Ü–µ–Ω–∫–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∏ –ø–µ—Ä–µ—Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è.

### –ü–æ—á–µ–º—É –≤–∞–∂–Ω–æ –∏–∑–º–µ—Ä—è—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–∑–≤–ª–µ—á–µ–Ω–∏—è

–ù–∞—à–∞ —Ü–µ–ª—å ‚Äî –æ—Ü–µ–Ω–∏—Ç—å, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ö–æ—Ä–æ—à–æ –Ω–∞—à–∞ –º–æ–¥–µ–ª—å –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏—è –∏ –≤–µ–∫—Ç–æ—Ä–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã —Ç–µ–∫—Å—Ç–∞-–∫–∞–Ω–¥–∏–¥–∞—Ç–∞. –ü–æ —Å—É—Ç–∏, –º—ã –ø—ã—Ç–∞–µ–º—Å—è –≤—ã—è—Å–Ω–∏—Ç—å: ¬´–ù–∞—Ö–æ–¥—è—Ç—Å—è –ª–∏ –Ω—É–∂–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –≥–¥–µ-—Ç–æ –≤ —Ç–æ–ø-k –∏–∑–≤–ª–µ—á—ë–Ω–Ω—ã—Ö –Ω–∞–±–æ—Ä–∞—Ö?¬ª –∏–ª–∏ ¬´–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ª–∏ –Ω–∞—à –≤–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ–ª–Ω—ã–π –º—É—Å–æ—Ä?¬ª üòõ –°—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–µ—Ä, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å, —á—Ç–æ–±—ã –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ —ç—Ç–æ—Ç –≤–æ–ø—Ä–æ—Å. –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∏–∑ –Ω–∏—Ö —Ä–æ–¥–æ–º –∏–∑ –æ–±–ª–∞—Å—Ç–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞.

–ü—Ä–µ–∂–¥–µ —á–µ–º –Ω–∞—á–∞—Ç—å, –ø–æ–ª–µ–∑–Ω–æ —Ä–∞–∑–ª–∏—á–∞—Ç—å –¥–≤–∞ —Ç–∏–ø–∞ –º–µ—Ä ‚Äî **–±–∏–Ω–∞—Ä–Ω—ã–µ** –∏ **–≥—Ä–∞–¥—É–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ** —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏. –ë–æ–ª–µ–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ, –±–∏–Ω–∞—Ä–Ω—ã–µ –º–µ—Ä—ã —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏–∑—É—é—Ç –∏–∑–≤–ª–µ—á—ë–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç –ª–∏–±–æ –∫–∞–∫ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–π, –ª–∏–±–æ –∫–∞–∫ –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–π –¥–ª—è –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –∑–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ‚Äî —Å—Ä–µ–¥–Ω–µ–≥–æ –Ω–µ –¥–∞–Ω–æ. –ù–∞–ø—Ä–æ—Ç–∏–≤, –≥—Ä–∞–¥—É–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ä—ã –ø—Ä–∏—Å–≤–∞–∏–≤–∞—é—Ç –∑–Ω–∞—á–µ–Ω–∏–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ –∫–∞–∂–¥–æ–º—É –∏–∑–≤–ª–µ—á—ë–Ω–Ω–æ–º—É —Ç–µ–∫—Å—Ç–æ–≤–æ–º—É —Ñ—Ä–∞–≥–º–µ–Ω—Ç—É, –≥–¥–µ-—Ç–æ –≤ —Å–ø–µ–∫—Ç—Ä–µ –æ—Ç –ø–æ–ª–Ω–æ–π –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ –¥–æ –ø–æ–ª–Ω–æ–π —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏.

### –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –±–∏–Ω–∞—Ä–Ω—ã–µ –º–µ—Ä—ã, –Ω–µ —É—á–∏—Ç—ã–≤–∞—é—â–∏–µ –ø–æ—Ä—è–¥–æ–∫

–ë–∏–Ω–∞—Ä–Ω—ã–µ –º–µ—Ä—ã, –Ω–µ —É—á–∏—Ç—ã–≤–∞—é—â–∏–µ –ø–æ—Ä—è–¥–æ–∫, –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —è–≤–ª—è—é—Ç—Å—è –Ω–∞–∏–±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç—ã–º–∏ –∏ –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ –ø–æ–Ω—è—Ç–Ω—ã–º–∏. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –æ–Ω–∏ —è–≤–ª—è—é—Ç—Å—è –æ—Ç–ª–∏—á–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–Ω–æ–π —Ç–æ—á–∫–æ–π –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è —Ç–æ–≥–æ, —á—Ç–æ –∏–º–µ–Ω–Ω–æ –º—ã –ø—ã—Ç–∞–µ–º—Å—è –∏–∑–º–µ—Ä–∏—Ç—å –∏ –æ—Ü–µ–Ω–∏—Ç—å. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω—ã–µ –∏ –ø–æ–ª–µ–∑–Ω—ã–µ –±–∏–Ω–∞—Ä–Ω—ã–µ, –Ω–µ —É—á–∏—Ç—ã–≤–∞—é—â–∏–µ –ø–æ—Ä—è–¥–æ–∫ –º–µ—Ä—ã ‚Äî —ç—Ç–æ **HitRate@k**, **Recall@k**, **Precision@k** –∏ **F1@k**.

#### üéØ **HitRate@K**

**HitRate@K** ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç–µ–π—à–∞—è –∏–∑ –≤—Å–µ—Ö –º–µ—Ä –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è. –≠—Ç–æ –±–∏–Ω–∞—Ä–Ω–∞—è –º–µ—Ä–∞, —É–∫–∞–∑—ã–≤–∞—é—â–∞—è, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ —Ç–æ–ø-k –∏–∑–≤–ª–µ—á—ë–Ω–Ω—ã—Ö —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ö –∏–ª–∏ –Ω–µ—Ç. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –æ–Ω –º–æ–∂–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ç–æ–ª—å–∫–æ –¥–≤–∞ –∑–Ω–∞—á–µ–Ω–∏—è: –ª–∏–±–æ 1 (–µ—Å–ª–∏ –≤ –∏–∑–≤–ª–µ—á—ë–Ω–Ω–æ–º –Ω–∞–±–æ—Ä–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç), –ª–∏–±–æ 0 (–µ—Å–ª–∏ –Ω–∏ –æ–¥–∏–Ω –∏–∑ –∏–∑–≤–ª–µ—á—ë–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–º).

#### üéØ **Recall@K**

**Recall@K** –≤—ã—Ä–∞–∂–∞–µ—Ç, –∫–∞–∫ —á–∞—Å—Ç–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –ø–æ—è–≤–ª—è—é—Ç—Å—è –≤ —Ç–æ–ø-k –∏–∑–≤–ª–µ—á—ë–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö. –ü–æ —Å—É—Ç–∏, –æ–Ω –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ö–æ—Ä–æ—à–æ –Ω–∞–º —É–¥–∞–ª–æ—Å—å –∏–∑–±–µ–∂–∞—Ç—å –ª–æ–∂–Ω—ã—Ö –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤. **Recall@k** —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

#### üéØ **Precision@k**

**Precision@k** —É–∫–∞–∑—ã–≤–∞–µ—Ç, —Å–∫–æ–ª—å–∫–æ –∏–∑ —Ç–æ–ø-k –∏–∑–≤–ª–µ—á—ë–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã. –ü–æ —Å—É—Ç–∏, –æ–Ω –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ö–æ—Ä–æ—à–æ –Ω–∞–º —É–¥–∞–ª–æ—Å—å –∏–∑–±–µ–∂–∞—Ç—å –ª–æ–∂–Ω—ã—Ö –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤. **Precision@k** –º–æ–∂–Ω–æ —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

#### üéØ **F1@K**

–ù–æ —á—Ç–æ, –µ—Å–ª–∏ –Ω–∞–º –Ω—É–∂–Ω—ã –∫–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ, —Ç–∞–∫ –∏ –ø–æ–ª–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã ‚Äî —á—Ç–æ, –µ—Å–ª–∏ –Ω–∞–º –Ω—É–∂–µ–Ω –∏–∑–≤–ª–µ—á—ë–Ω–Ω—ã–π –Ω–∞–±–æ—Ä, —á—Ç–æ–±—ã –∏–º–µ—Ç—å –≤—ã—Å–æ–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –∫–∞–∫ Recall, —Ç–∞–∫ –∏ Precision? –ß—Ç–æ–±—ã –¥–æ—Å—Ç–∏—á—å —ç—Ç–æ–≥–æ, Recall@K –∏ Precision@K –º–æ–∂–Ω–æ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –≤ –µ–¥–∏–Ω—É—é –º–µ—Ä—É, –Ω–∞–∑—ã–≤–∞–µ–º—É—é **F1@K**, —á—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –Ω–∞–º —Å–æ–∑–¥–∞—Ç—å –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å, –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –±–∞–ª–∞–Ω—Å–∏—Ä—É—é—â–∏–π –¥–æ—Å—Ç–æ–≤–µ—Ä–Ω–æ—Å—Ç—å –∏ –ø–æ–ª–Ω–æ—Ç—É –∏–∑–≤–ª–µ—á—ë–Ω–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.

### –¢–∞–∫ —Ö–æ—Ä–æ—à –ª–∏ –Ω–∞—à –≤–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫?

–¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫ –≤—Å—ë —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ ¬´–í–æ–π–Ω—ã –∏ –º–∏—Ä–∞¬ª, –æ—Ç–≤–µ—Ç–∏–≤ –µ—â—ë —Ä–∞–∑ –Ω–∞ –º–æ–π –ª—é–±–∏–º—ã–π –≤–æ–ø—Ä–æ—Å ‚Äî ¬´–ö—Ç–æ —Ç–∞–∫–∞—è –ê–Ω–Ω–∞ –ü–∞–≤–ª–æ–≤–Ω–∞?¬ª. –ö–∞–∫ –∏ –≤ –º–æ–∏—Ö –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –ø–æ—Å—Ç–∞—Ö, —è —Å–Ω–æ–≤–∞ –±—É–¥—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç ¬´–í–æ–π–Ω—ã –∏ –º–∏—Ä–∞¬ª –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–∏–º–µ—Ä–∞, –ª–∏—Ü–µ–Ω–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–∞–∫ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –¥–æ—Å—Ç–æ—è–Ω–∏–µ –∏ –ª–µ–≥–∫–æ –¥–æ—Å—Ç—É–ø–Ω—ã–π —á–µ—Ä–µ–∑ Project Gutenberg.

### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –æ—Ü–µ–Ω–∫–∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è

–í –Ω–∞—á–∞–ª–µ –Ω–∞—à–µ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞ –º—ã –º–æ–∂–µ–º –¥–æ–±–∞–≤–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑–¥–µ–ª, —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –æ—Ü–µ–Ω–∫–∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –º—ã —Ö–æ—Ç–∏–º —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å:

```python
def normalize_text(text):
    return " ".join(text.lower().split())

def hit_rate_at_k(retrieved_docs, ground_truth_texts, k):
    for doc in retrieved_docs[:k]:
        doc_norm = normalize_text(doc.page_content)
        if any(normalize_text(gt) in doc_norm or doc_norm in normalize_text(gt) for gt in ground_truth_texts):
            return True
    return False

def precision_at_k(retrieved_docs, ground_truth_texts, k):
    hits = 0
    for doc in retrieved_docs[:k]:
        doc_norm = normalize_text(doc.page_content)
        if any(normalize_text(gt) in doc_norm or doc_norm in normalize_text(gt) for gt in ground_truth_texts):
            hits += 1
    return hits / k

def recall_at_k(retrieved_docs, ground_truth_texts, k):
    matched = set()
    for i, gt in enumerate(ground_truth_texts):
        gt_norm = normalize_text(gt)
        for doc in retrieved_docs[:k]:
            doc_norm = normalize_text(doc.page_content)
            if gt_norm in doc_norm or doc_norm in gt_norm:
                matched.add(i)
                break
    return len(matched) / len(ground_truth_texts) if ground_truth_texts else 0

def f1_at_k(precision, recall):
    return 2 * precision * recall / (precision + recall) if (precision + recall) > 0 else 0
```

–ß—Ç–æ–±—ã —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å –ª—é–±—É—é –∏–∑ —ç—Ç–∏—Ö –æ—Ü–µ–Ω–æ—á–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫, –Ω–∞–º –Ω—É–∂–Ω–æ —Å–Ω–∞—á–∞–ª–∞ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –Ω–∞–±–æ—Ä –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –∏–º –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã. –≠—Ç–æ –¥–æ–≤–æ–ª—å–Ω–æ –æ–±—ä—ë–º–Ω–∞—è —Ä–∞–±–æ—Ç–∞; –ø–æ—ç—Ç–æ–º—É —è –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é –ø—Ä–æ—Ü–µ—Å—Å —Ç–æ–ª—å–∫–æ –¥–ª—è –æ–¥–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ ‚Äî ¬´–ö—Ç–æ —Ç–∞–∫–∞—è –ê–Ω–Ω–∞ –ü–∞–≤–ª–æ–≤–Ω–∞?¬ª ‚Äî –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∏–∑–≤–ª–µ—á–µ–Ω—ã.

–í –ª—é–±–æ–º —Å–ª—É—á–∞–µ —ç—Ç–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è ‚Äî –ª–∏–±–æ –¥–ª—è –æ–¥–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞, –ª–∏–±–æ –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –æ—Ü–µ–Ω–æ–∫ ‚Äî –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –≤ –≤–∏–¥–µ **—Å–ª–æ–≤–∞—Ä—è –∏—Å—Ç–∏–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏**, –ø–æ–∑–≤–æ–ª—è—é—â–µ–≥–æ –Ω–∞–º —Å–æ–ø–æ—Å—Ç–∞–≤–∏—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–º–∏ —Ç–µ–∫—Å—Ç–æ–≤—ã–º–∏ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞–º–∏.

–í —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, –º—ã –º–æ–∂–µ–º —Å—á–∏—Ç–∞—Ç—å, —á—Ç–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–º–∏ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤–∫–ª—é—á–µ–Ω—ã –≤ —Å–ª–æ–≤–∞—Ä—å –∏—Å—Ç–∏–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –¥–ª—è –Ω–∞—à–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ ¬´–ö—Ç–æ —Ç–∞–∫–∞—è –ê–Ω–Ω–∞ –ü–∞–≤–ª–æ–≤–Ω–∞?¬ª, —è–≤–ª—è—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ:

1. ¬´–≠—Ç–æ –±—ã–ª–æ –≤ –∏—é–ª–µ 1805 –≥–æ–¥–∞, –∏ –æ—Ä–∞—Ç–æ—Ä–æ–º –±—ã–ª–∞ –∏–∑–≤–µ—Å—Ç–Ω–∞—è –ê–Ω–Ω–∞ –ü–∞–≤–ª–æ–≤–Ω–∞ –®–µ—Ä–µ—Ä, —Ñ—Ä–µ–π–ª–∏–Ω–∞ –∏ –ª—é–±–∏–º–∏—Ü–∞ –∏–º–ø–µ—Ä–∞—Ç—Ä–∏—Ü—ã –ú–∞—Ä–∏–∏ –§—ë–¥–æ—Ä–æ–≤–Ω—ã. –° —ç—Ç–∏–º–∏ —Å–ª–æ–≤–∞–º–∏ –æ–Ω–∞ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–æ–≤–∞–ª–∞ –∫–Ω—è–∑—è –í–∞—Å–∏–ª–∏—è –ö—É—Ä–∞–≥–∏–Ω–∞, —á–µ–ª–æ–≤–µ–∫–∞ –≤—ã—Å–æ–∫–æ–≥–æ —Ä–∞–Ω–≥–∞ –∏ –≤–∞–∂–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–≤—ã–º –ø—Ä–∏–±—ã–ª –Ω–∞ –µ—ë –ø—Ä–∏—ë–º. –£ –ê–Ω–Ω—ã –ü–∞–≤–ª–æ–≤–Ω—ã –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –±—ã–ª –∫–∞—à–µ–ª—å. –û–Ω–∞, –∫–∞–∫ —Å–∫–∞–∑–∞–ª–∞, –±–æ–ª–µ–ª–∞ –≥—Ä–∏–ø–ø–æ–º; –≥—Ä–∏–ø–ø —Ç–æ–≥–¥–∞ –±—ã–ª –Ω–æ–≤—ã–º —Å–ª–æ–≤–æ–º –≤ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥–µ, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–º —Ç–æ–ª—å–∫–æ —ç–ª–∏—Ç–æ–π. –í—Å–µ –µ—ë –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è –±–µ–∑ –∏—Å–∫–ª—é—á–µ–Ω–∏—è, –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–µ –ø–æ-—Ñ—Ä–∞–Ω—Ü—É–∑—Å–∫–∏ –∏ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ –ª–∞–∫–µ–µ–º –≤ –∞–ª–æ–π –ª–∏–≤—Ä–µ–µ –≤ —Ç–æ —É—Ç—Ä–æ, –≤—ã–≥–ª—è–¥–µ–ª–∏ —Ç–∞–∫: ‚Äû–ï—Å–ª–∏ —É –≤–∞—Å –Ω–µ—Ç –Ω–∏—á–µ–≥–æ –±–æ–ª–µ–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–≥–æ, –≥—Ä–∞—Ñ (–∏–ª–∏ –∫–Ω—è–∑—å), –∏ –µ—Å–ª–∏ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–∞ –ø—Ä–æ–≤–µ—Å—Ç–∏ –≤–µ—á–µ—Ä —Å –±–µ–¥–Ω–æ–π –±–æ–ª—å–Ω–æ–π –Ω–µ —Å–ª–∏—à–∫–æ–º —É–∂–∞—Å–Ω–∞, —è –±—É–¥—É –æ—á–µ–Ω—å —Ä–∞–¥–∞ –≤–∏–¥–µ—Ç—å –≤–∞—Å —Å–µ–≥–æ–¥–Ω—è –º–µ–∂–¥—É 7 –∏ 10 ‚Äî –ê–Ω–Ω–µ—Ç –®–µ—Ä–µ—Ä‚Äú¬ª.
2. ¬´–ü—Ä–∏—ë–º –ê–Ω–Ω—ã –ü–∞–≤–ª–æ–≤–Ω—ã –±—ã–ª –ø–æ—Ö–æ–∂ –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π, —Ç–æ–ª—å–∫–æ –Ω–æ–≤–∏–Ω–∫–æ–π, –∫–æ—Ç–æ—Ä—É—é –æ–Ω–∞ –ø—Ä–µ–¥–ª–æ–∂–∏–ª–∞ —Å–≤–æ–∏–º –≥–æ—Å—Ç—è–º –Ω–∞ —ç—Ç–æ—Ç —Ä–∞–∑, –±—ã–ª –Ω–µ –ú–æ—Ä—Ç–µ–º–∞—Ä—Ç, –∞ –¥–∏–ø–ª–æ–º–∞—Ç –∏–∑ –ë–µ—Ä–ª–∏–Ω–∞ —Å —Å–∞–º—ã–º–∏ —Å–≤–µ–∂–∏–º–∏ –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç—è–º–∏ –æ –≤–∏–∑–∏—Ç–µ –∏–º–ø–µ—Ä–∞—Ç–æ—Ä–∞ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–∞ –≤ –ü–æ—Ç—Å–¥–∞–º –∏ –æ —Ç–æ–º, –∫–∞–∫ –¥–≤–∞ –∞–≤–≥—É—Å—Ç–µ–π—à–∏—Ö –¥—Ä—É–≥–∞ –ø–æ–∫–ª—è–ª–∏—Å—å –≤ –Ω–µ—Ä–∞–∑—Ä—ã–≤–Ω–æ–º —Å–æ—é–∑–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –¥–µ–ª–æ —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç–∏ –ø—Ä–æ—Ç–∏–≤ –≤—Ä–∞–≥–∞ —Ä–æ–¥–∞ —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–≥–æ. –ê–Ω–Ω–∞ –ü–∞–≤–ª–æ–≤–Ω–∞ –ø—Ä–∏–Ω—è–ª–∞ –ü—å–µ—Ä–∞ —Å –æ—Ç—Ç–µ–Ω–∫–æ–º –º–µ–ª–∞–Ω—Ö–æ–ª–∏–∏, –æ—á–µ–≤–∏–¥–Ω–æ –æ—Ç–Ω–æ—Å—è—â–∏–º—Å—è –∫ –Ω–µ–¥–∞–≤–Ω–µ–π –ø–æ—Ç–µ—Ä–µ –º–æ–ª–æ–¥–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞ —Å–º–µ—Ä—Ç—å—é –≥—Ä–∞—Ñ–∞ –ë–µ–∑—É—Ö–æ–≤–∞ (–≤—Å–µ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —Å—á–∏—Ç–∞–ª–∏ —Å–≤–æ–∏–º –¥–æ–ª–≥–æ–º –∑–∞–≤–µ—Ä–∏—Ç—å –ü—å–µ—Ä–∞, —á—Ç–æ –æ–Ω –±—ã–ª –≥–ª—É–±–æ–∫–æ –æ–≥–æ—Ä—á—ë–Ω —Å–º–µ—Ä—Ç—å—é –æ—Ç—Ü–∞, –∫–æ—Ç–æ—Ä–æ–≥–æ –µ–¥–≤–∞ –∑–Ω–∞–ª), –∏ –µ—ë –º–µ–ª–∞–Ω—Ö–æ–ª–∏—è –±—ã–ª–∞ —Ç–∞–∫–æ–π –∂–µ, –∫–∞–∫ –∞–≤–≥—É—Å—Ç–µ–π—à–∞—è –º–µ–ª–∞–Ω—Ö–æ–ª–∏—è, –∫–æ—Ç–æ—Ä—É—é –æ–Ω–∞ –ø–æ–∫–∞–∑—ã–≤–∞–ª–∞ –ø—Ä–∏ —É–ø–æ–º–∏–Ω–∞–Ω–∏–∏ –µ—ë –∞–≤–≥—É—Å—Ç–µ–π—à–µ–≥–æ –í–µ–ª–∏—á–µ—Å—Ç–≤–∞ –∏–º–ø–µ—Ä–∞—Ç—Ä–∏—Ü—ã –ú–∞—Ä–∏–∏ –§—ë–¥–æ—Ä–æ–≤–Ω—ã. –ü—å–µ—Ä –±—ã–ª –ø–æ–ª—å—â—ë–Ω —ç—Ç–∏–º. –ê–Ω–Ω–∞ –ü–∞–≤–ª–æ–≤–Ω–∞ —É—Å—Ç—Ä–æ–∏–ª–∞ —Ä–∞–∑–Ω—ã–µ –≥—Ä—É–ø–ø—ã –≤ —Å–≤–æ–µ–π –≥–æ—Å—Ç–∏–Ω–æ–π —Å–æ —Å–≤–æ–∏–º –æ–±—ã—á–Ω—ã–º –º–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ–º¬ª.
3. ¬´–ì–æ—Å—Ç–∏–Ω–∞—è —Å –µ—ë –æ–±—ã—á–Ω—ã–º –º–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ–º. –ë–æ–ª—å—à–∞—è –≥—Ä—É–ø–ø–∞, –≤ –∫–æ—Ç–æ—Ä–æ–π –±—ã–ª–∏ –ø—Ä–∏–Ω—Ü –í–∞—Å–∏–ª–∏–π –∏ –≥–µ–Ω–µ—Ä–∞–ª—ã, –ø–æ–ª—É—á–∏–ª–∞ –ø–æ–ª—å–∑—É –æ—Ç –¥–∏–ø–ª–æ–º–∞—Ç–∞. –î—Ä—É–≥–∞—è –≥—Ä—É–ø–ø–∞ –±—ã–ª–∞ –∑–∞ —á–∞–π–Ω—ã–º —Å—Ç–æ–ª–æ–º. –ü—å–µ—Ä —Ö–æ—Ç–µ–ª –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ –ø–µ—Ä–≤–æ–π, –Ω–æ –ê–Ω–Ω–∞ –ü–∞–≤–ª–æ–≤–Ω–∞ ‚Äî –∫–æ—Ç–æ—Ä–∞—è –±—ã–ª–∞ –≤ –≤–æ–∑–±—É–∂–¥—ë–Ω–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏, –∫–∞–∫ –∫–æ–º–∞–Ω–¥–∏—Ä –Ω–∞ –ø–æ–ª–µ –±–æ—è, –≤ –≥–æ–ª–æ–≤–µ –∫–æ—Ç–æ—Ä–æ–≥–æ —Ç—ã—Å—è—á–∏ –Ω–æ–≤—ã—Ö –∏ –±–ª–µ—Å—Ç—è—â–∏—Ö –∏–¥–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –µ–¥–≤–∞ –ª–∏ —É—Å–ø–µ–≤–∞—é—Ç –≤–æ–ø–ª–æ—Ç–∏—Ç—å –≤ –∂–∏–∑–Ω—å, ‚Äî —É–≤–∏–¥–µ–≤ –ü—å–µ—Ä–∞, –∫–æ—Å–Ω—É–ª–∞—Å—å –µ–≥–æ —Ä—É–∫–∞–≤–∞ –ø–∞–ª—å—Ü–µ–º, –≥–æ–≤–æ—Ä—è:¬ª

–í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –º—ã –º–æ–∂–µ–º –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∏—Å—Ç–∏–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–ª—è —ç—Ç–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤, —Å–æ–¥–µ—Ä–∂–∞—â–∏—Ö –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å, —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

```python
query = "Who is Anna P√°vlovna?"

ground_truth_texts = [
    "It was in July, 1805, and the speaker was the well-known Anna P√°vlovna Sch√©rer, maid of honor and favorite of the Empress M√°rya F√´dorovna. With these words she greeted Prince Vas√≠li Kur√°gin, a man of high rank and importance, who was the first to arrive at her reception. Anna P√°vlovna had had a cough for some days. She was, as she said, suffering from la grippe; grippe being then a new word in St. Petersburg, used only by the elite. All her invitations without exception, written in French, and delivered by a scarlet-liveried footman that morning, ran as follows: ‚ÄúIf you have nothing better to do, Count (or Prince), and if the prospect of spending an evening with a poor invalid is not too terrible, I shall be very charmed to see you tonight between 7 and 10 ‚Äî Annette Sch√©rer.‚Äù",
    "Anna P√°vlovna‚Äôs ‚ÄúAt Home‚Äù was like the former one, only the novelty she offered her guests this time was not Mortemart, but a diplomatist fresh from Berlin with the very latest details of the Emperor Alexander‚Äôs visit to Potsdam, and of how the two august friends had pledged themselves in an indissoluble alliance to uphold the cause of justice against the enemy of the human race. Anna P√°vlovna received Pierre with a shade of melancholy, evidently relating to the young man‚Äôs recent loss by the death of Count Bez√∫khov (everyone constantly considered it a duty to assure Pierre that he was greatly afflicted by the death of the father he had hardly known), and her melancholy was just like the august melancholy she showed at the mention of her most august Majesty the Empress M√°rya F√´dorovna. Pierre felt flattered by this. Anna P√°vlovna arranged the different groups in her drawing room with her habitual skill. The large group, in which were",
    "drawing room with her habitual skill. The large group, in which were Prince Vas√≠li and the generals, had the benefit of the diplomat. Another group was at the tea table. Pierre wished to join the former, but Anna P√°vlovna‚Äîwho was in the excited condition of a commander on a battlefield to whom thousands of new and brilliant ideas occur which there is hardly time to put in action‚Äîseeing Pierre, touched his sleeve with her finger, saying:"
]
```

–ù–∞–∫–æ–Ω–µ—Ü, –º—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ–º –¥–æ–±–∞–≤–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑–¥–µ–ª –≤ –Ω–∞—à—É —Ñ—É–Ω–∫—Ü–∏—é `main()`, —á—Ç–æ–±—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å –∏ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –æ—Ü–µ–Ω–æ—á–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏:

```python
...

k_ = 10

D, I = index.search(query_embedding, k=k_)

relevant_docs = [vector_store.docstore[i] for i in I[0]]

reranked_docs, reranked_scores = rerank_with_cross_encoder(user_input, relevant_docs)

top_k_docs = reranked_docs[:k_]  
precision = precision_at_k(top_k_docs, ground_truth_texts, k=k_)
recall = recall_at_k(top_k_docs, ground_truth_texts, k=k_)
f1 = f1_at_k(precision, recall)
hit = hit_rate_at_k(top_k_docs, ground_truth_texts, k=k_)

print("\n--- Retrieval Evaluation Metrics ---")
print(f"Hit@6: {hit}")
print(f"Precision@6: {precision:.2f}")
print(f"Recall@6: {recall:.2f}")
print(f"F1@6: {f1:.2f}")
print("-" * 40)

...
```

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –º—ã –∑–∞–ø—É—Å–∫–∞–µ–º –æ—Ü–µ–Ω–∫—É **–ø–æ—Å–ª–µ –ø–µ—Ä–µ—Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è**. –ü–æ—Å–∫–æ–ª—å–∫—É –º–µ—Ç—Ä–∏–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –º—ã —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º ‚Äî —Ç–∞–∫–∏–µ –∫–∞–∫ Precision@K, Recall@K –∏ F1@K ‚Äî **–Ω–µ —É—á–∏—Ç—ã–≤–∞—é—Ç –ø–æ—Ä—è–¥–æ–∫**, –æ—Ü–µ–Ω–∫–∞ –∏—Ö –Ω–∞ —Ç–æ–ø-k –∏–∑–≤–ª–µ—á—ë–Ω–Ω—ã—Ö —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ö –¥–æ –∏–ª–∏ –ø–æ—Å–ª–µ –ø–µ—Ä–µ—Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞—ë—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, –µ—Å–ª–∏ –Ω–∞–±–æ—Ä —Ç–æ–ø-k —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –æ—Å—Ç–∞—ë—Ç—Å—è –ø—Ä–µ–∂–Ω–∏–º.

–ò—Ç–∞–∫, –¥–ª—è –Ω–∞—à–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞ ¬´–ö—Ç–æ —Ç–∞–∫–∞—è –ê–Ω–Ω–∞ –ü–∞–≤–ª–æ–≤–Ω–∞?¬ª –∏ @k = 10 –º—ã –ø–æ–ª—É—á–∞–µ–º —Å–ª–µ–¥—É—é—â–∏–µ –æ—Ü–µ–Ω–∫–∏:

* @k = 10, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –º—ã —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –≤—Å–µ –æ—Ü–µ–Ω–æ—á–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –Ω–∞ —Ç–æ–ø-10 –∏–∑–≤–ª–µ—á—ë–Ω–Ω—ã—Ö —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ö.
* Hit@10 = True, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –∏–∑ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö (–∏—Å—Ç–∏–Ω–Ω—ã—Ö) —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤ –±—ã–ª –Ω–∞–π–¥–µ–Ω –≤ —Ç–æ–ø-10 –∏–∑–≤–ª–µ—á—ë–Ω–Ω—ã—Ö —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ö.
* Precision@10 = 0,20, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –∏–∑ 10 –∏–∑–≤–ª–µ—á—ë–Ω–Ω—ã—Ö —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤ —Ç–æ–ª—å–∫–æ 2 –±—ã–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ (0,20 = 2/10). –î—Ä—É–≥–∏–º–∏ —Å–ª–æ–≤–∞–º–∏, –∏—Å–∫–∞—Ç–µ–ª—å —Ç–∞–∫–∂–µ –ø—Ä–∏–Ω—ë—Å –Ω–µ–Ω—É–∂–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é; —Ç–æ–ª—å–∫–æ 20% –∏–∑ —Ç–æ–≥–æ, —á—Ç–æ –æ–Ω –∏–∑–≤–ª—ë–∫, –±—ã–ª–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ø–æ–ª–µ–∑–Ω–æ.
* Recall@10 = 0,67, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –º—ã –∏–∑–≤–ª–µ–∫–ª–∏ 67% –≤—Å–µ—Ö —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤, –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≤ –∏—Å—Ç–∏–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –≤ —Ç–æ–ø-10 –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö.
* F1@10 = 0,31, —á—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –æ–±—â–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è, —Å–æ—á–µ—Ç–∞—é—â–µ–µ –∫–∞–∫ —Ç–æ—á–Ω–æ—Å—Ç—å, —Ç–∞–∫ –∏ –æ—Ç–∑—ã–≤—á–∏–≤–æ—Å—Ç—å. –û—Ü–µ–Ω–∫–∞ F1 –≤ 0,31 —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —É–º–µ—Ä–µ–Ω–Ω—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –∏ –º—ã –∑–Ω–∞–µ–º, —á—Ç–æ —ç—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å –ø—Ä–∏–ª–∏—á–Ω–æ–π –æ—Ç–∑—ã–≤—á–∏–≤–æ—Å—Ç—å—é, –Ω–æ –Ω–∏–∑–∫–æ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é.

–ö–∞–∫ —É–ø–æ–º–∏–Ω–∞–ª–æ—Å—å —Ä–∞–Ω–µ–µ, –º—ã –º–æ–∂–µ–º —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å —ç—Ç–∏ –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –ª—é–±–æ–≥–æ k ‚Äî –∏–º–µ–µ—Ç —Å–º—ã—Å–ª —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –¥–ª—è –∑–Ω–∞—á–µ–Ω–∏–π k, –ø—Ä–µ–≤—ã—à–∞—é—â–∏—Ö –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤ –Ω–∞ –∑–∞–ø—Ä–æ—Å –≤ –∏—Å—Ç–∏–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –º—ã –º–æ–∂–µ–º —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ k –∏ –ø–æ–Ω–∏–º–∞—Ç—å, –∫–∞–∫ –Ω–∞—à–∞ —Å–∏—Å—Ç–µ–º–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ –º–µ—Ä–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –∏–ª–∏ —Å—É–∂–µ–Ω–∏—è –æ–±–ª–∞—Å—Ç–∏ –∏–∑–≤–ª–µ—á—ë–Ω–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.

### –í –∑–∞–∫–ª—é—á–µ–Ω–∏–µ

–ü–æ–∫–∞ —Ç–∞–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏, –∫–∞–∫ Precision@K, Recall@K –∏ F1@K, –º–æ–≥—É—Ç –±—ã—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω—ã –¥–ª—è **–æ–¥–∏–Ω–æ—á–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞** –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ –Ω–∞–±–æ—Ä–∞ –∏–∑–≤–ª–µ—á—ë–Ω–Ω—ã—Ö —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤ (–∫–∞–∫ –º—ã —ç—Ç–æ —Å–¥–µ–ª–∞–ª–∏ –∑–¥–µ—Å—å), –≤ —Ä–µ–∞–ª—å–Ω–æ–π –æ—Ü–µ–Ω–∫–µ –æ–Ω–∏ –æ–±—ã—á–Ω–æ –æ—Ü–µ–Ω–∏–≤–∞—é—Ç—Å—è –ø–æ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤, –∏–∑–≤–µ—Å—Ç–Ω–æ–π –∫–∞–∫ —Ç–µ—Å—Ç–æ–≤—ã–π –Ω–∞–±–æ—Ä. –ë–æ–ª–µ–µ —Ç–æ—á–Ω–æ, –∫–∞–∂–¥–æ–º—É –∑–∞–ø—Ä–æ—Å—É –≤ —Ç–µ—Å—Ç–æ–≤–æ–º –Ω–∞–±–æ—Ä–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–≤–æ–π –Ω–∞–±–æ—Ä —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤ –∏—Å—Ç–∏–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏. –ú—ã –∑–∞—Ç–µ–º —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –º–µ—Ç—Ä–∏–∫–∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞, –∞ –∑–∞—Ç–µ–º —É—Å—Ä–µ–¥–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ –≤—Å–µ–º –∑–∞–ø—Ä–æ—Å–∞–º.

–í –∫–æ–Ω–µ—á–Ω–æ–º —Å—á—ë—Ç–µ, –ø–æ–Ω–∏–º–∞–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å, –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –≤–∞–∂–Ω–æ –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–Ω–≤–µ–π–µ—Ä–∞ RAG. –°–∞–º–æ–µ –≥–ª–∞–≤–Ω–æ–µ, —á—Ç–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º –∏–∑–≤–ª–µ—á–µ–Ω–∏—è ‚Äî –ø–æ–∏—Å–∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ ‚Äî —è–≤–ª—è–µ—Ç—Å—è –æ—Å–Ω–æ–≤–æ–π –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Å–º—ã—Å–ª–µ–Ω–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ —Å –ø–æ–º–æ—â—å—é –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ RAG.

